## é¢˜å•

+ [åŸºç¡€ç®—æ³•](https://www.luogu.com.cn/training/2929)
+ [æ‹“å±•æ¨¡æ¿](https://www.luogu.com.cn/training/2650)  éš¾åº¦è¾ƒå¤§
+ [æé«˜æ•°æ®ç»“æ„](https://www.luogu.com.cn/training/2649)
+ [è¿›é˜¶æ•°æ®ç»“æ„](https://www.luogu.com.cn/training/3367#information)
+ [DPåŸºç¡€](https://www.luogu.com.cn/training/5011)
+ [åŠ¨æ€è§„åˆ’æé«˜](https://www.luogu.com.cn/training/12927)
+ [åŠ¨æ€è§„åˆ’ç»¼åˆ](https://www.luogu.com.cn/training/1435#information)
+ [æ•°è®º](https://www.luogu.com.cn/training/3135#information)
+ [å›¾è®ºæ¨¡æ¿](https://www.luogu.com.cn/training/3364)
+ [æé«˜å›¾è®º](https://www.luogu.com.cn/training/4969)
+ [æ€ç»´é¢˜](https://www.luogu.com.cn/training/4865#problems)
+ [ç»¼åˆ](https://www.luogu.com.cn/training/9391)



## BASE

### å¿«é€Ÿå¹‚

æœ€å¿«çš„å¿«é€Ÿå¹‚ç®—æ³•ï¼Œè¿ç”¨äº†ä½è¿ç®—å¤§å¤§åŠ å¿«è¿ç®—é€Ÿåº¦ã€‚

```cpp
long long fastPower(long long base, long long power) {
    long long result = 1;
    while (power > 0) {
        if (power & 1) {//æ­¤å¤„ç­‰ä»·äºif(power%2==1)
            result = result * base ;
        }
        power >>= 1;//æ­¤å¤„ç­‰ä»·äºpower=power/2
        base = (base * base) ;
    }
    return result;
}
```



### çŸ©é˜µå¿«é€Ÿå¹‚

**å…ˆä¿®çŸ¥è¯†ï¼šçº¿æ€§ä»£æ•°  ï¼ˆç‹—å¤´ï¼‰**

æ—¶é—´å¤æ‚åº¦ï¼š$O(log_2k)$ 

```cpp
struct matrix
{
    int n,m;   
    int e[105][105];
}
matrix a,b;

matrix mul(matrix a,matrix b)
{
    matrix ans;
    ans.n=a.n;
    ans.m=b.m;
    
    for(int i=1;i<=ans.m;i++)
   		for(int j=1;j<=ans.m;j++)
            ans.e[i][j]=0;     //åˆå§‹åŒ–
    
    for(int i=1;i<=a.n;i++)
        for(int j=1;j<=b.m;j++)
            for(int k=1;k<=a.m;k++)
                ans.e[i][j]=(ans.e[i][j]+(a.e[i][k]*b.e[k][j])%mod)%mod;//å¿«é€Ÿå¹‚çš„å–æ¨¡å°±åœ¨è¿™é‡Œäº†ï¼
    return ans;
}

matrix power(matrix a,ll b)
{
    matrix ans;
    ans.n=a.n;
    ans.m=a.m;
    //åˆå§‹åŒ–ä¸ºå•å…ƒçŸ©é˜µ
    for(int i=1;i<=ans.n;i++)
    	for(int j=1;j<=ans.m;j++)
            if(i==j) 
                ans.e[i][j]=1;
    		else 
                ans.e[i][j]=0;    
    
    while(b)
    {
        if(b&1)
            ans=mul(ans,a);
       	a=mul(a,a);
        b>>=1;
    }
    return ans;
}
```



### bitset

[åšå®¢](https://www.cnblogs.com/zwfymqz/p/8696631.html)



### STç®—æ³•

**RMQ**ï¼šåŒºé—´æœ€å¤§å€¼/æœ€å°å€¼æŸ¥è¯¢

**å¤æ‚åº¦**

é¢„å¤„ç†ï¼š`O(nlogn)`

æŸ¥è¯¢ï¼š`O(1)`



**å®ç°**

é¢„å¤„ç†ï¼Œç®—å‡ºæ¯ä¸ªåŒºé—´ä¹‹é—´çš„æœ€å€¼ã€‚

`s[i][j]` ä»£è¡¨ä»iå¼€å§‹ç¬¬$2^j$ ä¸ªæ•°ã€‚

```cpp
void init(int x)
{
  	for(int i=1;i<=n;i++)
        st[i][0]=a[i];
  	
  	for(int j=1;(1<<j)=sizeof(a);j++)
    {
      	for(int i=1;i+(1<<(j-1))<=sizeof(a);i++)
        {
          	st[i][j] = max(st[i][j-1],st[i+(1<<(j-1))][j-1]);
        }
    }
}
```



**æŸ¥è¯¢**

```cpp
int Log[n+7];
void getLog()
{
	Log[1] = 0;
	for(int i=2;i<=n+1;i++)
		Log[i] = Log[i/2]+1;
}

int query(int l,int r)
{
   int k = Log(r-l+1);
   ans = max(st[l][k],st[r-(1<<k)+1][k];
   return ans;
}
```



## å­—ç¬¦ä¸²ç®—æ³•

### KMP

ç”¨äºåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¾“å‡ºä½ç½®ã€‚

+ ç”¨ä¸€ä¸ª`nex`æ•°ç»„ç»´æŠ¤ æœ€é•¿çš„ å‰ç¼€ä¸åç¼€ç›¸åŒçš„å­ä¸²ï¼ˆæœ€å¤§ä¸º n-1 ï¼‰
+ ä»å‰å¾€åéå†ï¼Œå¦‚æœç¬¦åˆå­—ç¬¦ä¸²aä¸å­—ç¬¦ä¸²bçš„è¿™ä¸ªä½ç½®çš„å­—æ¯ç›¸åŒï¼Œé‚£ä¹ˆ+1,å¦åˆ™å›é€€åˆ°`nex[j]`

[![vL7nn1.png](https://s1.ax1x.com/2022/09/10/vL7nn1.png)](https://imgse.com/i/vL7nn1)

```cpp
cin >> a + 1;
cin >> b + 1;
la = strlen(a + 1);
lb = strlen(b + 1);
for (int i = 2; i <= lb; i++) //æ±‚nexæ•°ç»„
{
    while (j && b[i] != b[j + 1])
        j = kmp[j];
    if (b[j + 1] == b[i])
        j++;
    kmp[i] = j;
}
j = 0;
for (int i = 1; i <= la; i++)
{
    while (j > 0 && b[j + 1] != a[i])
        j = kmp[j];
    if (b[j + 1] == a[i])
        j++;
    if (j == lb)
    {
        cout << i - lb + 1 << endl;
        j = kmp[j];
    }
}

for (int i = 1; i <= lb; i++)
    cout << kmp[i] << " ";
```



### Manacher

æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œæ±‚è§£ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡å­ä¸²é•¿åº¦ã€‚

[![vOSklV.png](https://s1.ax1x.com/2022/09/10/vOSklV.png)](https://imgse.com/i/vOSklV)

[![vOSAyT.png](https://s1.ax1x.com/2022/09/10/vOSAyT.png)](https://imgse.com/i/vOSAyT)

```cpp
void manacher()
{
    int r = 0, mid = 0;
    int size = strlen(a + 1);
    s[++cnt] = '~';
    s[++cnt] = '#';
    for (int i = 1; i <= size; i++)
    {
        s[++cnt] = a[i];
        s[++cnt] = '#';
    }
    s[++cnt] = '!';

    for (int i = 2; i <= cnt - 1; i++)
    {
        p[i] = r > i ? min(r - i, p[2 * mid - i]) : 1;
        while (s[i + p[i]] == s[i - p[i]])
        {
            p[i]++;
        }
        if (i + p[i] > r)
        {
            r = i + p[i];
            mid = i;
        }
        ans = max(ans, p[i] - 1);
    }
}
```



### ACè‡ªåŠ¨æœº



### å›æ–‡è‡ªåŠ¨æœºï¼ˆPAMï¼‰



### åç¼€æ•°ç»„



### åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰







## æ•°æ®ç»“æ„

### é“¾è¡¨

**å­˜å‚¨çº¿æ€§è¡¨çš„æ•°æ®å…ƒç´ ï¼Œå¯ä»¥æ˜¯ä¸è¿ç»­çš„**

##### åŠ¨æ€é“¾è¡¨

```c++
#åˆå§‹åŒ–
struct node{
    int data;
    node *next;
};

node *head, *p, *now, *prev;

head = new node;          //å®šä¹‰å˜é‡
head->data = 1;          //åˆ†é…ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•°æ®ç½®ä¸º1
head->next = NULL;  //
now = head;  //å½“å‰æŒ‡é’ˆä¸ºå¤´æŒ‡é’ˆ
```



##### ç»“æ„ä½“å®ç°é“¾è¡¨

```c++
(å•å‘)
struct node{
    int id;
    int nextid;
}nodes[maxn];

nodes[0].nextid = 1;
for(int i=1;i<=n;i++)
{
    nodes[i].id=i;
    nodes[i].nextid = i+1;
}
nodes[n].nextid = 1;  //å¾ªç¯é“¾è¡¨

```



##### STL list

listä¸ºåŒå‘é“¾è¡¨ã€‚

```c++
//åˆå§‹åŒ–
list<int> l1;  //ç©ºå¯¹è±¡
list<int> l2(3,1); //åŒ…å«3ä¸ª1çš„å¯¹è±¡

//éå†

list<int>::iterator it = l2.begin();
while(it != l2.end())
{
    *it += 1;
    cout<<*it<<' ';
    it++;
}

//èŒƒå›´foréå†
for(auto& e:l2)
{
    cout<<e<<' ';
}

//æ’å…¥
l1.push_back(xx);
l1.push_front(xx);
l1.pop_front();
l1.pop_back();

insert:
auto pos = ++l1.begin();
l1.insert(pos,5); //åœ¨posä½ç½®å‰åŠ ä¸€ä¸ª5
l1.insert(pos,3,5); //åœ¨posä½ç½®å‰åŠ 3ä¸ª5

erase:
l1.erase(pos);   //åˆ é™¤posä½ç½®å…ƒç´ 
l1.erase(++le.begin(),--l1.end());  //åˆ é™¤ä¸­é—´å†…å®¹


//æ¸…ç©ºï¼š
l1.clear();

```



### å¹¶æŸ¥é›†

**ä¸€ç§æ ‘å½¢æ•°æ®ç»“æ„ï¼Œç”¨äºå¤„ç†ä¸äº¤é›†çš„åˆå¹¶åŠæŸ¥è¯¢é—®é¢˜**

#### åˆ›å»º

```c
void init(int size){
    for(int i=0;i<size;i++)
    {
        fa[i]=i;
    }
}
```



#### æŸ¥æ‰¾

```c
int find(int x){
    if(fa[x]==x)
        return x;
    else
        return find(fa[x]);
}

//è·¯å¾„å‹ç¼©ç‰ˆæœ¬

int find(int x){
    if(fa[x]!=x)
        fa[x]=find(fa[x]);
    return fa[x];
}
```



#### åˆå¹¶

```c
viod merge(int x,int y){
    x=find(x);
    y=find(y);
    fa[x]=y;
}
```



#### å¯å‘å¼åˆå¹¶ï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰

è¿ç”¨äºï¼š å¯æŒä¹…åŒ–å¹¶æŸ¥é›†ã€çº¿æ®µæ ‘åˆ†æ²» + å¹¶æŸ¥é›†

```c
//é€‰æ‹©ç‚¹æ•°ä½œä¸ºä¼°ä»·å‡½æ•°

vector<int> size(N,1);  //è®°å½•å¹¶åˆå§‹åŒ–å­æ ‘çš„å¤§å°ä¸º1

void merge(int x,int y){
    int xx = find(x);
    int yy = find(y);
    if(xx == yy) return;
    if(siez[xx] > size[yy])  // ä¿è¯å°çš„åˆå¹¶åˆ°å¤§çš„
        swap(xx,yy);
    fa[xx]=yy;
    size[yy]+=size[xx];
}
```





### æ ‘çŠ¶æ•°ç»„

#### åœºæ™¯

å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ã€‚



#### å¤æ‚åº¦

æ—¶é—´å¤æ‚åº¦ï¼š æŸ¥è¯¢ä¸ä¿®æ”¹å‡ä¸º $log(n)$



**æ ¹æœ¬**ï¼š

```cpp
int lowbit(int x)   //ä½œç”¨ï¼šæ‰¾åˆ°æœ€åä¸€ä½
{
    return x&(-x);
}
```



**æ±‚å‰ç¼€å’Œ** 

```cpp
int getSum(int m){
	int ans = 0;
    while(m > 0){
        ans += C[m];
        m -= lowbit(m);
    }
    return ans;
}
```



**æ›´æ–°**

```cpp
void update(int x, int value){
    A[x] += value;	// ä¿®æ”¹æºæ•°ç»„
    while(x <= n){
        C[x] += value;
        x += lowbit(x);
    }
}

```



**ç¤ºæ„å›¾**ï¼š

![image.png](https://s2.loli.net/2022/07/22/9QK5rJvCuyUDms7.png)













### çº¿æ®µæ ‘

#### åœºæ™¯

+ å•ç‚¹ä¿®æ”¹ã€åŒºé—´ä¿®æ”¹
+ æŸ¥è¯¢åŒºé—´çš„å€¼



#### æ“ä½œ

##### å»ºæ ‘

```cpp
void build(int k,int l,int r)
{
    if(l==r)
        t[k] = a[i];
   	else
    {
        int m = (r-l)<<1+l;
        build(k<<1,l,m);
        build(k<<|1,m+1,r);
    }
}
```

##### ç‚¹æ›´æ–°

```cpp
void update(int p,int v,int k,int l,int r) //ç‚¹æ›´æ–°
{
    if(l==r)
    {
        a[k] += v;
        t[k] += v;
    }
    else{
        int m = (r - l) / 2 + l;
        if (p <= m)
        {
            update(p, v, k << 1, l, m);
        }
        else{
            update(p, v, k << 1 | 1, m + 1, r);
        }
        Pushup(k);
    }
}
```

##### åŒºé—´æ›´æ–°

```cpp
void Update(int L,int R,int v,int k,int l,int r) //åŒºé—´æ›´æ–°
{
    if(L<=l && R>=r)
    {
        t[k]+=v;
        lazy[k] += v;
    }
    else
    {
        Pushdown(k);
        int m = (r - l) / 2 + l;
        if(L<=m)
        {
            Update(L, R, v, k >> 1, l, m);
        }
        if(R>m)
        {
            Update(L, R, v, k >> 1 | 1, m + 1, r);
        }
        Pushup(k);
    }
}
```

##### åŒºé—´æ±‚æœ€å€¼

```cpp

ll ask(int L,int R,int k,int l,int r)   //åŒºé—´æŸ¥è¯¢æœ€å€¼
{
    if(L<=l && R>=r)
        return t[k];
    else
    {
        Pushdown(k);
        ll ans = INF;
        int m = (r - l) / 2 + l;
        if(L<=m)
            ans = max(ans, ask(L, R, k << 1, l, m));
        if(R>=m+1)
            ans = max(ans, ask(L, R, k >> 1 | 1, m + 1, r));

        return ans;
    }
}

```



##### ä¸Šå‡

```cpp
void pushup(int k)
{
    t[k] = t[k << 1] + t[k << 1 | 1];
}
```

##### ä¸‹é™

```cpp
void pushdown(int k, int l, int r)
{
    int m = (l + r) >> 1;
    if (lazy[k] != 0)
    {
        lazy[k << 1] +=lazy[k];
        lazy[k << 1 | 1] += lazy[k];
        t[k << 1] += lazy[k] * (m - l + 1);
        t[k << 1 | 1] += lazy[k] * (r - m);
        lazy[k] = 0;
    }
}
```

### Tireæ ‘

[![vO1KS0.png](https://s1.ax1x.com/2022/09/10/vO1KS0.png)](https://imgse.com/i/vO1KS0)

å¦‚å›¾ï¼Œæ¶‚çº¢çš„ä»£è¡¨å½“å‰ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€åä¸€ä¸ªç»“ç‚¹

```cpp
const int N = 1000050;
int trie[N][26];
int cnt[N];
int id;

void insert(string s)
{
	int p = 0;
	for (int i = 0; i < s.size(); i++)
	{
		int x = s[i] - 'a';
		if (trie[p][x] == 0) trie[p][x] = ++id;
		p = trie[p][x];
	}
	cnt[p]++;
}

int  find(string s)
{
	int p = 0;
	for (int i = 0; i < s.size(); i++)
	{
		int x = s[i] - 'a';
		if (trie[p][x] == 0)return 0;
		p = trie[p][x];
	}
	return cnt[p];
}
```







### æ™®é€šå¹³è¡¡æ ‘

```cpp
int RD(){
    int out = 0,flag = 1;char c = getchar();
    while(c < '0' || c >'9'){if(c == '-')flag = -1;c = getchar();}
    while(c >= '0' && c <= '9'){out = out * 10 + c - '0';c = getchar();}
    return flag * out;
    }
//ç¬¬ä¸€æ¬¡æ‰“treapï¼Œä¸å‹è¡Œå†™æ³¨é‡ŠXD
const int maxn = 1000019,INF = 1e9;
//å¹³è¡¡æ ‘ï¼Œåˆ©ç”¨BSTæ€§è´¨æŸ¥è¯¢å’Œä¿®æ”¹ï¼Œåˆ©ç”¨éšæœºå’Œå †ä¼˜å…ˆçº§æ¥ä¿æŒå¹³è¡¡ï¼ŒæŠŠæ ‘çš„æ·±åº¦æ§åˆ¶åœ¨log Nï¼Œä¿è¯äº†æ“ä½œæ•ˆç‡
//åŸºæœ¬å¹³è¡¡æ ‘æœ‰ä»¥ä¸‹å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å‡½æ•°ï¼šæ–°å»ºï¼Œæ’å…¥ï¼Œåˆ é™¤ï¼Œæ—‹è½¬
//èŠ‚ç‚¹çš„åŸºæœ¬å±æ€§æœ‰val(å€¼)ï¼Œdat(éšæœºå‡ºæ¥çš„ä¼˜å…ˆçº§)
//é€šè¿‡å¢åŠ å±æ€§ï¼Œç»“åˆBSTçš„æ€§è´¨å¯ä»¥è¾¾åˆ°ä¸€äº›æ•ˆæœï¼Œå¦‚size(å­æ ‘å¤§å°ï¼ŒæŸ¥è¯¢æ’å)ï¼Œcnt(æ¯ä¸ªèŠ‚ç‚¹åŒ…å«çš„å‰¯æœ¬æ•°)ç­‰
int na;
int ch[maxn][2];//[i][0]ä»£è¡¨iå·¦å„¿å­ï¼Œ[i][1]ä»£è¡¨iå³å„¿å­
int val[maxn],dat[maxn];
int size[maxn],cnt[maxn];
int tot,root;
int New(int v){//æ–°å¢èŠ‚ç‚¹ï¼Œ
	val[++tot] = v;//èŠ‚ç‚¹èµ‹å€¼
	dat[tot] = rand();//éšæœºä¼˜å…ˆçº§
	size[tot] = 1;//ç›®å‰æ˜¯æ–°å»ºå¶å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥å­æ ‘å¤§å°ä¸º1
	cnt[tot] = 1;//æ–°å»ºèŠ‚ç‚¹åŒç†å‰¯æœ¬æ•°ä¸º1
	return tot;
	}
void pushup(int id){//å’Œçº¿æ®µæ ‘çš„pushupæ›´æ–°ä¸€æ ·
	size[id] = size[ch[id][0]] + size[ch[id][1]] + cnt[id];//æœ¬èŠ‚ç‚¹å­æ ‘å¤§å° = å·¦å„¿å­å­æ ‘å¤§å° + å³å„¿å­å­æ ‘å¤§å° + æœ¬èŠ‚ç‚¹å‰¯æœ¬æ•°
	}
void build(){
	root = New(-INF),ch[root][1] = New(INF);//å…ˆåŠ å…¥æ­£æ— ç©·å’Œè´Ÿæ— ç©·ï¼Œä¾¿äºä¹‹åæ“ä½œ(è²Œä¼¼ä¸åŠ ä¹Ÿè¡Œ)
	pushup(root);//å› ä¸ºINF > -INF,æ‰€ä»¥æ˜¯å³å­æ ‘ï¼Œ
	}
void Rotate(int &id,int d){//idæ˜¯å¼•ç”¨ä¼ é€’ï¼Œd(irection)ä¸ºæ—‹è½¬æ–¹å‘ï¼Œ0ä¸ºå·¦æ—‹ï¼Œ1ä¸ºå³æ—‹
	int temp = ch[id][d ^ 1];//æ—‹è½¬ç†è§£ï¼šæ‰¾ä¸ªåŠ¨å›¾çœ‹ä¸€çœ‹å°±å¥½(æˆ–å‚è§å…¶ä»–OIerçš„blog)
	ch[id][d ^ 1] = ch[temp][d];//è¿™é‡Œè®²ä¸€ä¸ªè®°å¿†æŠ€å·§ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯è¢«è®°å½•åé©¬ä¸Šä¿®æ”¹
	ch[temp][d] = id;//æ‰€ä»¥åƒâ€œZâ€ä¸€æ ·
	id = temp;//æ¯”å¦‚è¿™ä¸ªidï¼Œåœ¨ä¸Šä¸€è¡Œæ‰è¢«è®°å½•è¿‡ï¼Œch[temp][d]ã€ch[id][d ^ 1]ä¹Ÿæ˜¯ä¸€æ ·çš„
	pushup(ch[id][d]),pushup(id);//æ—‹è½¬ä»¥åsizeä¼šæ”¹å˜ï¼Œçœ‹å›¾å°±ä¼šå‘ç°åªæ›´æ–°è‡ªå·±å’Œè½¬ä¸Šæ¥çš„ç‚¹ï¼Œpushupä¸€ä¸‹,æ³¨æ„å…ˆå­èŠ‚ç‚¹å†çˆ¶èŠ‚ç‚¹
	}//æ—‹è½¬å®è´¨æ˜¯({åœ¨æ»¡è¶³BSTçš„æ€§è´¨çš„åŸºç¡€ä¸Šæ¯”è¾ƒä¼˜å…ˆçº§}é€šè¿‡äº¤æ¢æœ¬èŠ‚ç‚¹å’Œå…¶æŸä¸ªå¶å­èŠ‚ç‚¹)æŠŠé“¾å‰å¼€æˆäºŒå‰å½¢çŠ¶(ä»è€Œæ§åˆ¶æ·±åº¦)ï¼Œå¯ä»¥çœ‹å›¾ç†è§£ä¸€ä¸‹
void insert(int &id,int v){//idä¾ç„¶æ˜¯å¼•ç”¨ï¼Œåœ¨æ–°å»ºèŠ‚ç‚¹æ—¶å¯ä»¥ä½“ç°
	if(!id){
		id = New(v);//è‹¥èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹
		return ;
		}
	if(v == val[id])cnt[id]++;//è‹¥èŠ‚ç‚¹å·²å­˜åœ¨ï¼Œåˆ™å‰¯æœ¬æ•°++;
	else{//è¦æ»¡è¶³BSTæ€§è´¨ï¼Œå°äºæ’åˆ°å·¦è¾¹ï¼Œå¤§äºæ’åˆ°å³è¾¹
		int d = v < val[id] ? 0 : 1;//è¿™ä¸ªdæ˜¯æ–¹å‘çš„æ„æ€ï¼ŒæŒ‰ç…§BSTçš„æ€§è´¨ï¼Œå°äºæœ¬èŠ‚ç‚¹åˆ™å‘å·¦ï¼Œå¤§äºå‘å³
		insert(ch[id][d],v);//é€’å½’å®ç°
		if(dat[id] < dat[ch[id][d]])Rotate(id,d ^ 1);//(å‚è€ƒä¸€ä¸‹å›¾)ä¸å·¦èŠ‚ç‚¹äº¤æ¢å³æ—‹ï¼Œä¸å³èŠ‚ç‚¹äº¤æ¢å·¦æ—‹
		}
	pushup(id);//ç°åœ¨æ›´æ–°ä¸€ä¸‹æœ¬èŠ‚ç‚¹çš„ä¿¡æ¯
	}
void Remove(int &id,int v){//æœ€éš¾çš„éƒ¨åˆ†äº†
	if(!id)return ;//åˆ°è¿™äº†å‘ç°æŸ¥ä¸åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼Œè¯¥ç‚¹ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›
	if(v == val[id]){//æ£€ç´¢åˆ°äº†è¿™ä¸ªå€¼
		if(cnt[id] > 1){cnt[id]--,pushup(id);return ;}//è‹¥å‰¯æœ¬ä¸æ­¢ä¸€ä¸ªï¼Œå‡å»ä¸€ä¸ªå°±å¥½
		if(ch[id][0] || ch[id][1]){//å‘ç°åªæœ‰ä¸€ä¸ªå€¼ï¼Œä¸”æœ‰å„¿å­èŠ‚ç‚¹,æˆ‘ä»¬åªèƒ½æŠŠå€¼æ—‹è½¬åˆ°åº•éƒ¨åˆ é™¤
			if(!ch[id][1] || dat[ch[id][0]] > dat[ch[id][1]]){//å½“å‰ç‚¹è¢«ç§»èµ°ä¹‹åï¼Œä¼šæœ‰ä¸€ä¸ªæ–°çš„ç‚¹è¡¥ä¸Šæ¥(å·¦å„¿å­æˆ–å³å„¿å­)ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§å¤§çš„è¡¥ä¸Šæ¥
				Rotate(id,1),Remove(ch[id][1],v);//æˆ‘ä»¬ä¼šå‘ç°ï¼Œå³æ—‹æ˜¯ä¸å·¦å„¿å­äº¤æ¢ï¼Œå½“å‰ç‚¹å˜æˆå³èŠ‚ç‚¹ï¼›å·¦æ—‹åˆ™æ˜¯ä¸å³å„¿å­äº¤æ¢ï¼Œå½“å‰ç‚¹å˜ä¸ºå·¦èŠ‚ç‚¹
				}
			else Rotate(id,0),Remove(ch[id][0],v);
			pushup(id);
			}
		else id = 0;//å‘ç°æœ¬èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼Œç›´æ¥åˆ é™¤
		return ;//è¿™ä¸ªreturnå¯¹åº”çš„æ˜¯æ£€ç´¢åˆ°å€¼deæ‰€æœ‰æƒ…å†µ
		}
	v < val[id] ? Remove(ch[id][0],v) : Remove(ch[id][1],v);//ç»§ç»­BSTæ€§è´¨
	pushup(id);
	}
int get_rank(int id,int v){
	if(!id)return 0;//è‹¥æŸ¥è¯¢å€¼ä¸å­˜åœ¨ï¼Œè¿”å›ï¼›å› ä¸ºæœ€åè¦å‡ä¸€æ’é™¤å“¨å…µèŠ‚ç‚¹ï¼Œæƒ³è¦ç»“æœä¸º-1è¿™é‡Œå°±è¿”å›0
	if(v == val[id])return size[ch[id][0]] + 1;//æŸ¥è¯¢åˆ°è¯¥å€¼ï¼Œç”±BSTæ€§è´¨å¯çŸ¥ï¼šè¯¥ç‚¹å·¦è¾¹å€¼éƒ½æ¯”è¯¥ç‚¹çš„å€¼(æŸ¥è¯¢å€¼)å°ï¼Œæ•…rankä¸ºå·¦å„¿å­å¤§å° + 1
	else if(v < val[id])return get_rank(ch[id][0],v);//å‘ç°éœ€æŸ¥è¯¢çš„ç‚¹åœ¨è¯¥ç‚¹å·¦è¾¹ï¼Œå¾€å·¦è¾¹é€’å½’æŸ¥è¯¢
	else return size[ch[id][0]] + cnt[id] + get_rank(ch[id][1],v);//è‹¥æŸ¥è¯¢å€¼å¤§äºè¯¥ç‚¹å€¼ã€‚è¯´æ˜è¯¢é—®ç‚¹åœ¨å½“å‰ç‚¹çš„å³ä¾§ï¼Œä¸”æ­¤ç‚¹çš„å€¼éƒ½å°äºæŸ¥è¯¢å€¼ï¼Œæ‰€ä»¥è¦åŠ ä¸Šcnt[id]
	}
int get_val(int id,int rank){
	if(!id)return INF;//ä¸€ç›´å‘å³æ‰¾æ‰¾ä¸åˆ°ï¼Œè¯´æ˜æ˜¯æ­£æ— ç©·
	if(rank <= size[ch[id][0]])return get_val(ch[id][0],rank);//å·¦è¾¹æ’åå·²ç»å¤§äºrankäº†ï¼Œè¯´æ˜rankå¯¹åº”çš„å€¼åœ¨å·¦å„¿å­é‚£é‡Œ
		else if(rank <= size[ch[id][0]] + cnt[id])return val[id];//ä¸Šä¸€æ­¥æ’é™¤äº†åœ¨å·¦åŒºé—´çš„æƒ…å†µï¼Œè‹¥æ˜¯rankåœ¨å·¦ä¸ä¸­(ç›®å‰èŠ‚ç‚¹)ä¸­ï¼Œåˆ™ç›´æ¥è¿”å›ç›®å‰èŠ‚ç‚¹(ä¸­åŒºé—´)çš„å€¼
	else return get_val(ch[id][1],rank - size[ch[id][0]] - cnt[id]);//å‰©ä¸‹åªèƒ½åœ¨å³åŒºé—´æ‰¾äº†ï¼Œrankå‡å»å·¦åŒºé—´å¤§å°å’Œä¸­åŒºé—´ï¼Œç»§ç»­é€’å½’
	}
int get_pre(int v){
	int id = root,pre;//é€’å½’ä¸å¥½è¿”å›ï¼Œä»¥å¾ªç¯æ±‚è§£
	while(id){//æŸ¥åˆ°èŠ‚ç‚¹ä¸å­˜åœ¨ä¸ºæ­¢
		if(val[id] < v)pre = val[id],id = ch[id][1];//æ»¡è¶³å½“å‰èŠ‚ç‚¹æ¯”ç›®æ ‡å°ï¼Œå¾€å½“å‰èŠ‚ç‚¹çš„å³ä¾§å¯»æ‰¾æœ€ä¼˜å€¼
		else id = ch[id][0];//æ— è®ºæ˜¯æ¯”ç›®æ ‡èŠ‚ç‚¹å¤§è¿˜æ˜¯ç­‰äºç›®æ ‡èŠ‚ç‚¹ï¼Œéƒ½ä¸æ»¡è¶³å‰é©±æ¡ä»¶ï¼Œåº”å¾€æ›´å°å¤„é è¿‘
		}
	return pre;
	}
int get_next(int v){
	int id = root,next;
	while(id){
		if(val[id] > v)next = val[id],id = ch[id][0];//åŒç†ï¼Œæ»¡è¶³æ¡ä»¶å‘å·¦å¯»æ‰¾æ›´å°è§£(ä¹Ÿå°±æ˜¯æœ€ä¼˜è§£)
		else id = ch[id][1];//ä¸ä¸Šæ–¹åŒç†
		}
	return next;
	}
int main(){
	build();//ä¸è¦å¿˜è®°åˆå§‹åŒ–[è¿è¡Œbuild()ä¼šè¿åŒrootä¸€å¹¶åˆå§‹åŒ–ï¼Œæ‰€ä»¥å¾ˆé‡è¦]
	na = RD();
	for(int i = 1;i <= na;i++){
		int cmd = RD(),x = RD();
		if(cmd == 1)insert(root,x);//å‡½æ•°éƒ½å†™å¥½äº†ï¼Œæ³¨æ„ï¼šéœ€è¦é€’å½’çš„å‡½æ•°éƒ½ä»æ ¹å¼€å§‹ï¼Œä¸éœ€è¦é€’å½’çš„å‡½æ•°ç›´æ¥æŸ¥è¯¢
		else if(cmd == 2)Remove(root,x);
		else if(cmd == 3)printf("%d\n",get_rank(root,x) - 1);//æ³¨æ„ï¼šå› ä¸ºåˆå§‹åŒ–æ—¶æ’å…¥äº†INFå’Œ-INF,æ‰€ä»¥æŸ¥è¯¢æ’åæ—¶è¦å‡1(-INFä¸æ˜¯ç¬¬ä¸€å°ï¼Œæ˜¯â€œç¬¬é›¶å°â€)
		else if(cmd == 4)printf("%d\n",get_val(root,x + 1));//åŒç†ï¼Œç”¨æ’åæŸ¥è¯¢å€¼å¾—æ—¶å€™è¦æŸ¥x + 1åï¼Œå› ä¸ºç¬¬ä¸€å(å…¶å®ä¸æ˜¯)æ˜¯-INF
		else if(cmd == 5)printf("%d\n",get_pre(x));
		else if(cmd == 6)printf("%d\n",get_next(x));
		}
	return 0;
}
```





### ç¬›å¡å°”æ ‘



```cpp
  for(int i=1;i<=n;i++){
        a[i]=read();
        while(a[sta[top]]>a[i]&&top) son[i][0]=sta[top--];
        if(sta[top]) son[sta[top]][1]=i;
        sta[++top]=i;
    }
    for(int i=1;i<=n;i++){
        lans=lans^(i*(son[i][0]+1));
        rans=rans^(i*(son[i][1]+1));
    }
```



## åŠ¨æ€è§„åˆ’

### æš´åŠ›DP

#### èƒŒåŒ…é—®é¢˜

##### åˆ†ç»„èƒŒåŒ…

è‹¥å¹²ç»„ç‰©å“ï¼Œæ¯ç»„ä¸­çš„ç‰©å“äº’ç›¸å†²çªï¼ˆå°±æ˜¯è¯´æ¯ç»„ä¸­æœ€å¤šåªèƒ½é€‰ä¸€ä»¶ç‰©å“ï¼‰ï¼Œæ±‚æœ€å¤§ä»·å€¼ã€‚

ä¼ªä»£ç ï¼š

```cpp
for(int k=1;k<=æ€»å…±çš„ç»„æ•°;k++)//éå†æ‰€æœ‰çš„ç»„k
	for(int j=v;j>=1;j--)//è·Ÿ01èƒŒåŒ…ç±»ä¼¼ï¼Œå€’åºæšä¸¾èƒŒåŒ…å®¹é‡
    	for(int i=1;i<=ç»„ä¸­çš„å…ƒç´ ä¸ªæ•°;i++)//éå†è¿™ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ 
        
        
//å¦ä¸€ä¸ªç‰ˆæœ¬çš„ä¼ªä»£ç 
        
for (int i = 0åˆ°ç»„æ•°)
	for (int j = max_våˆ°0)
		for (int k = æ­¤ç»„æ‰€æœ‰ç‰©å“)
			f[j] = max (f[j], f[j - v[k]] + w[k])
```



#### çŠ¶å‹DP

åˆ©ç”¨äºŒè¿›åˆ¶æ•°è¡¨ç¤ºçŠ¶æ€ï¼Œé€šè¿‡æšä¸¾æ‰€æœ‰çŠ¶æ€è¿›è¡ŒåŠ¨æ€è§„åˆ’ã€‚



#### åŒºé—´DP

>  åŒºé—´dpå°±æ˜¯åœ¨åŒºé—´ä¸Šè¿›è¡Œ**åŠ¨æ€è§„åˆ’**ï¼Œæ±‚è§£ä¸€æ®µåŒºé—´ä¸Šçš„æœ€ä¼˜è§£ã€‚ä¸»è¦æ˜¯é€šè¿‡åˆå¹¶å°åŒºé—´çš„ æœ€ä¼˜è§£è¿›è€Œå¾—å‡ºæ•´ä¸ªå¤§åŒºé—´ä¸Šæœ€ä¼˜è§£çš„dpç®—æ³•ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè¦æ±‚ä¸€ä¸ªå¤§åŒºé—´ä¸­çš„æœ€ä¼˜è§£ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªå¾ˆå¤§çš„åŒºé—´ä¸æ–­åˆ†å‰²ï¼Œå˜æˆå¾ˆå°çš„ä¸€ä¸ªä¸ªåŒºé—´ï¼Œæ±‚å‡ºæ¯ä¸ªå°åŒºé—´çš„æœ€ä¼˜è§£ï¼Œç„¶ååˆå¹¶èµ·æ¥ï¼Œæœ€ç»ˆæ‰¾å‡ºå®Œæ•´åŒºé—´çš„æœ€ä¼˜è§£å³å¯ã€‚

```cpp
for(int len = 1;len<=n;len++){//æšä¸¾é•¿åº¦
        for(int j = 1;j+len<=n+1;j++){//æšä¸¾èµ·ç‚¹ï¼Œends<=n
            int ends = j+len - 1;
            for(int i = j;i<ends;i++){//æšä¸¾åˆ†å‰²ç‚¹ï¼Œæ›´æ–°å°åŒºé—´æœ€ä¼˜è§£
                dp[j][ends] = min(dp[j][ends],dp[j][i]+dp[i+1][ends]+something);
            }
        }
}
```



#### æ•°ä½DP



### æ ‘å½¢DPğŸŒŸ

[åšå®¢](https://blog.csdn.net/m0_59459037/article/details/119189656)

ä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œå‘å­èŠ‚ç‚¹åšæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¹¶ç”±å…¶å­èŠ‚ç‚¹çš„æœ€ä¼˜è§£åˆå¹¶å¾—åˆ°è¯¥èŠ‚ç‚¹çš„æœ€ä¼˜è§£ã€‚

**å¥½å›¾**

[![vghfEQ.png](https://s1.ax1x.com/2022/08/25/vghfEQ.png)](https://imgse.com/i/vghfEQ)

#### æ ‘ä¸ŠåŠ¨æ€è§„åˆ’





#### æ ‘ä¸Š01èƒŒåŒ…





#### æ ‘ä¸Šå¤šé‡èƒŒåŒ…





#### æ¢æ ¹DP

åŸºäºæ ‘ä¸ŠDPï¼Œä½†æ˜¯é¢˜ç›®ä¸ç»™å‡ºå“ªä¸ªç‚¹æ˜¯æ ¹ç»“ç‚¹ï¼Œå› æ­¤éå†ä¸€è¾¹æ‰€æœ‰çš„ç‚¹ä»è€Œè¾¾åˆ°æŸä¸€ä¸ªç‚¹ä½œä¸ºæ ¹ç»“ç‚¹çš„æœ€ä½³æƒ…å†µã€‚

å¦‚æœæš´åŠ›åšï¼Œå¤æ‚åº¦ä¸º $O(n^2)$ ,åˆ©ç”¨æ¢æ ¹DPï¼Œå¯é™è‡³`O(n)`

**æ€è·¯**ï¼š

ç¬¬ä¸€é**dfs** é¢„å¤„ç†å‡ºçŠ¶æ€ï¼Œç¬¬äºŒéé€šè¿‡ **dfs** éå†æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹ï¼Œå¯¹æ¯ä¸ªç»“ç‚¹æ ¹æ®æ¨å¯¼å¼å¾—å‡ºç»“æœã€‚ 



```cpp
void dfs1(int x, int fa) //ç”¨æ¥æœç´¢å‡ºæ¯ä¸ªèŠ‚ç‚¹çš„æ·±åº¦å’Œå®ƒçš„å­æ ‘çš„å¤§å°
{

    size[x] = 1;
    dep[x] = dep[fa] + 1;
    for (int i = head[x]; i; i = e[i].next)
    {
        int v = e[i].to;
        if (v == fa)
            continue;
        dfs1(v, x);
        size[x] += size[v];
    }
}
void dfs2(int x, int fa) //ç”¨æ¥ä¸æ–­è½¬ç§»æ ¹èŠ‚ç‚¹æ¥æ‰¾åˆ°ç­”æ¡ˆ
{
    for (int i = head[x]; i; i = e[i].next)
    {
        int v = e[i].to;
        if (v == fa)
            continue;

        f[v] = f[x] + n - size[v] * 2;
        dfs2(v, x);
    }
}
```



#### è™šæ ‘

 ä¸€æ¬¡è¯¢é—®åªæ¶‰åŠåˆ°æ•´æ£µæ ‘ä¸­çš„å°‘é‡ç»“ç‚¹æ—¶ï¼Œå¯ä»¥å»ºç«‹ä¸€é¢—åŒ…å«å…³é”®èŠ‚ç‚¹çš„æ ‘ï¼Œç§°ä¸º**è™šæ ‘** 

èˆå»å¾ˆå¤šæ— ç”¨çš„ç»“ç‚¹ï¼Œå¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™åˆ°`O(nlogn)`

[![voMgDP.png](https://s1.ax1x.com/2022/09/03/voMgDP.png)](https://imgse.com/i/voMgDP)

ä¸¤ä¸ªå…³é”®èŠ‚ç‚¹ä¹‹å‰çš„è¿æ¥ç‚¹å°±æ˜¯ä»–ä»¬çš„**æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰**

**å»ºç«‹è™šæ ‘**

**ä¸€**ï¼šå­˜å›¾ï¼Œé¢„å¤„ç†`dfs`åº

```cpp
void dfs1(int pos)
{
    int k;
    for (k = 0; fa[pos][k]; k++)   //ç”¨äºä¹‹åå€å¢æ±‚LCA
    {
        fa[pos][k + 1] = fa[fa[pos][k]][k];
    }
    logmax[pos] = k; //è®°å½•æœ€å¤§2çš„å€æ•°
    dfn[pos] = ++id; //æ—¶é—´æˆ³
    for (int i = head1[pos]; i; i = e1[i].nex)
    {
        int to = e1[i].to;
        if (!dfn[to]) // æ²¡æœ‰å¤„ç†è¿‡è¯¥ç‚¹
        {
            deep[to] = deep[pos] + 1;
            minv[to] = min(minv[pos], e1[i].w);
            fa[to][0] = pos;
            dfs1(to);
        }
    }
}
```



**äºŒ** æ ¹æ®å››ç§æƒ…å†µè¿›è¡Œå¤„ç†ï¼Œå°†æ­£åœ¨å¤„ç†çš„é“¾ç§°ä½œ**â€œæœ€å³é“¾â€**

ç¬¬ä¸€ç§æƒ…å†µï¼š

[![v7kLSx.png](https://s1.ax1x.com/2022/09/05/v7kLSx.png)](https://imgse.com/i/v7kLSx)

ç¬¬äºŒç§æƒ…å†µï¼š

![image-20220905203533372](C:\Users\hy020\AppData\Roaming\Typora\typora-user-images\image-20220905203533372.png)

ç¬¬ä¸‰ç§æƒ…å†µï¼š

![image-20220905203605983](C:\Users\hy020\AppData\Roaming\Typora\typora-user-images\image-20220905203605983.png)

ç¬¬å››ç§æƒ…å†µï¼š

![image-20220905203620294](C:\Users\hy020\AppData\Roaming\Typora\typora-user-images\image-20220905203620294.png)

```cpp
st[top = 1] = lst[1];         //å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å…¥æ ˆ
for (int i = 2; i <= num; i++)   //å¤„ç†ä¹‹åæ¯ä¸€ä¸ªç»“ç‚¹
        {
            int now = lst[i];
            int lc = lca(now, st[top]);
            while (1)
            {
                if (deep[lc] >= deep[st[top - 1]])
                {
                    if (lc != st[top])
                    {
                        add2(lc, st[top]);
                        if (lc != st[top - 1])
                            st[top] = lc;
                        else
                            top--;
                    }
                    break;
                }
                else // 4
                {
                    add2(st[top - 1], st[top]);
                    top--;
                }
            }
            st[++top] = now;
        }
```



### DPä¼˜åŒ–

#### å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–

> å•è°ƒé˜Ÿåˆ—ï¼Œå³å•è°ƒé€’å‡æˆ–å•è°ƒé€’å¢çš„[é˜Ÿåˆ—](https://so.csdn.net/so/search?q=é˜Ÿåˆ—&spm=1001.2101.3001.7020)ã€‚













## å›¾è®º

### å•æºæœ€çŸ­è·¯å¾„

![vro8Og.png](https://s1.ax1x.com/2022/08/19/vro8Og.png)

#### Floyd

**æ€æƒ³** ï¼šæšä¸¾

æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$   ï¼Œ    ç©ºé—´å¤æ‚åº¦ï¼š $O(n^2)$

**é€‚ç”¨æ¡ä»¶** ï¼š ä¸èƒ½æœ‰è´Ÿç¯ï¼Œä¸”å¿…é¡»å­˜åœ¨æœ€çŸ­è·¯

```c++
for(int k = 1; k <= n; k++){
    for(int x = 1; x <= n; x++){
        for(int y = 1; y <= n; y++){
            f[x][y]= min(f[x][y], f[x][k]+f[k][y]);
        }
    }
}
```



#### SPFA

[åšå®¢](https://blog.csdn.net/qq_39670434/article/details/78464995)

##### æœ€çŸ­è·¯

**æ€è·¯**ï¼šç”±ä¸€ä¸ªç‚¹ä¸æ–­æ‰©å±•å­èŠ‚ç‚¹ï¼Œå¦‚æœèƒ½å¤Ÿè¿›è¡Œè¿­ä»£ï¼Œé‚£ä¹ˆå…¥é˜Ÿï¼Œè¢«å…¥é˜Ÿçš„ç‚¹å†è¿›è¡Œæ‰©å±•....

```cpp
void SPFA()
{
    for(int i=1;i<=n;i++)
    {
        dis[i]=maxint;
        vis[i]=false;
    }
    dis[s]=0;
    vis[s]=true;
    int u;
    q.push(s);
    while(!q.empty())
    {
        u=q.front();
        for(int i=head[u];i;i=e[i].nxt)
        	if(dis[u]+e[i].len<dis[e[i].to])
        	{
            	dis[e[i].to]=dis[u]+e[i].len;
            	if(vis[e[i].to]==false)
            	{
                	vis[e[i].to]=true;
                	q.push(e[i].to);
            	}
        	}
        vis[q.front()]=false;
      	q.pop();
    }
}
```



##### è´Ÿç¯

æ¯æ¬¡å…¥é˜Ÿçš„æ—¶å€™è®°å½•ä¸€ä¸‹

```cpp
bool SPFA() {
    dis[1] = 0;
    vis[1] = true;
    q.push(1);
    while (!q.empty()) {
        int u = q.front();
        q.pop();
        vis[u] = false;
        for (int i = head[u]; i; i = e[i].nex) {
            int to = e[i].to;
            if (e[i].val + dis[u] < dis[to]) {
                dis[to] = dis[u] + e[i].val;
                if (!vis[to]) {
                    q.push(to);
                    vis[to] = true;
                  	cnt[to] = cnt[u] + 1;
                		if (cnt[to] >= n) return true;  //å¦‚æœè¯¥ç‚¹å…¥é˜Ÿæ¬¡æ•°>=n,åˆ™æœ‰è´Ÿç¯ã€‚
                }
            }
        }
    }
    return false;
}
```



#### Dijkstra

**æ€æƒ³** ï¼šç±»ä¼¼äº Prim ï¼Œä¸æ–­æ‰¾åˆ°è€—è´¹æœ€å°çš„ç‚¹ï¼Œè¿›è¡Œæ ‡è®°ï¼Œç›´åˆ°è¾¾åˆ°ç›®æ ‡

æ—¶é—´å¤æ‚åº¦ï¼š $O(n^2)$    ï¼Œ  ç©ºé—´å¤æ‚åº¦ï¼š $O(m log m)$

```c++
const int inf=0x3f3f3f3f; //ä»£è¡¨æ— ç©·å¤§ã€‚
const int maxn=100;//æœ€å¤§é¡¶ç‚¹æ•°
int n,m;//nä¸ªé¡¶ç‚¹ï¼Œmæ¡è¾¹ã€‚
bool visited[maxn];//åˆ¤æ–­æ˜¯å¦ç¡®å®šåˆ°æºç‚¹çš„æœ€ç»ˆæœ€çŸ­è·ç¦»ã€‚
int graph[maxn][maxn];//å¸¦æƒå›¾
int dis[maxn];//é¡¶ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·ç¦»ã€‚
int start,goal;//èµ·ç‚¹ä¸ç›®æ ‡ç‚¹ã€‚


void init(){
	memset(visited,false,sizeof(visited));
	for(int i=1;i<=n;i++){
		dis[i]=graph[start][i];//åˆå§‹åŒ–disæ•°ç»„ã€‚
	}
}


void dijkstra(){
	//æºç‚¹ä¸ºæºç‚¹startã€‚
	int minn;//è®°å½•æ¯è¶Ÿæœ€çŸ­è·¯å¾„ä¸­æœ€å°çš„è·¯å¾„å€¼ã€‚ 
	int pos;//è®°å½•å¾—åˆ°çš„minnæ‰€å¯¹åº”çš„ä¸‹æ ‡ã€‚
	init();//è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ã€‚
	visited[start]=true;
	for(int i=1;i<=n;i++){
		//å°†nä¸ªé¡¶ç‚¹ä¾æ¬¡åŠ å…¥åˆ¤æ–­ã€‚
		minn=inf;
		for(int j=1;j<=n;j++){
			if(!visited[j]&&dis[j]<minn){
				minn=dis[j];
				pos=j;
			}
		}
		//ç»è¿‡è¿™è¶Ÿforå¾ªç¯åæˆ‘ä»¬æ‰¾åˆ°çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç‚¹ï¼Œå¯ä»¥ç¡®å®šè¿™ç‚¹åˆ°æºç‚¹çš„æœ€ç»ˆæœ€çŸ­è·ç¦»äº†ã€‚
		visited[pos]=true;//æˆ‘ä»¬å°†æ­¤ç‚¹å¹¶å…¥å·²çŸ¥é›†åˆã€‚
		//æ¥ä¸‹æ¥å°±æ˜¯æ›´æ–°disæ•°ç»„äº†ï¼Œä¹Ÿå°±æ˜¯å½“å‰æœ€çŸ­è·ç¦»ï¼Œè¿™éƒ½æ˜¯é’ˆå¯¹è¿˜æ²¡æœ‰å¹¶å…¥å·²çŸ¥é›†åˆçš„ç‚¹ã€‚
		for(int j=1;j<=n;j++){
			if(!visited[j]&&dis[j]>dis[pos]+graph[pos][j])
				dis[j]=dis[pos]+graph[pos][j];
		}
	}
	//é€€å‡ºå¾ªç¯åï¼Œæ‰€æœ‰çš„ç‚¹éƒ½å·²å¹¶å…¥å·²çŸ¥é›†åˆä¸­ï¼Œå¾—åˆ°çš„disæ•°ç»„ä¹Ÿå°±æ˜¯æœ€ç»ˆæœ€çŸ­è·ç¦»äº†ã€‚
	cout<<dis[goal]<<endl;//è¾“å‡ºç›®æ ‡ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚
}

```



##### ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ç‰ˆ

**æ€æƒ³** ï¼šåˆ©ç”¨æœ€å°å †ç»´æŠ¤æœ€å°å€¼ï¼Œä¸ç”¨å†å»å¾ªç¯æšä¸¾æ‰¾å‡ºæœ€å°å€¼ã€‚

**æ—¶é—´å¤æ‚åº¦**ï¼š$MlogM$

```cpp
typedef pair<int,int> pdd;

int head[maxn], dis[maxn];
bool vis[maxn];

struct Edge{
    itn u,v,w;
    int nex;
}e[maxm];

inline void add(int a,int b,int c)
{
    e[++cnt].u=a;
    e[cnt].v=b;
    e[cnt].w=c;
    e[cnt].nex=head[a];
    head[a]=cnt;
}

priority_queue<pdd,vector<pdd>,greater<pdd>> q;

void dijkstra()
{
    while(!empty())
    {
        pdd t = q.top();
        q.pop();
        int now = t.second;
        if(vis[now])
            continue;
        vie[now]=true;
        
        for(int i = head[now]; i; i = e[i].nex)
        {
            int to = e[i].v;
            if(dis[to]>dis[now]+e[i].w)
            {
                dis[to]= dis[now] + e[i].w;
                q.push({dis[to],to});
            }
        }
    }
    
}
```



### æ ‘ä¸Šé—®é¢˜

#### æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰

åšå®¢[é“¾æ¥](https://blog.csdn.net/qq_43332980/article/details/107437070?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107437070-blog-121195470.pc_relevant_multi_platform_featuressortv2removedup&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107437070-blog-121195470.pc_relevant_multi_platform_featuressortv2removedup)

##### å€å¢ï¼ˆåœ¨çº¿ï¼‰

**å¤æ‚åº¦**

é¢„å¤„ç†ï¼š`O(nlogn)`

å•æ¬¡æŸ¥è¯¢ï¼š`O(logn)`

æ€»å¤æ‚åº¦ï¼š`O(nlogn+mlogn)`

**å®ç°**

é‡‡ç”¨`f[x][i]`æ•°ç»„æ¥è¡¨ç¤ºç‚¹ x çš„ç¬¬ $2^i$ ä¸ªç¥–å…ˆ

```cpp
//é¢„å¤„ç†fæ•°ç»„
for(int i=1;(i<<i)<d[u];i++)
{
  	f[u][i] = f[f[u][i-1]][i-1];
}
```

```cpp
#include<bits/stdc++.h>
using namespace std;

const int MAX_N = 500000+7, MAX_M = 500000+7;

int n,m,s;
int d[MAX_N]; //ä¿å­˜èŠ‚ç‚¹æ·±åº¦
int f[MAX_N][21]; //ä¿å­˜èŠ‚ç‚¹çš„ä¸åŒå€æ•°çš„çˆ¶èŠ‚ç‚¹

int head[MAX_N], cnt=-1;
struct Edge{
    int to , next;
}e[MAX_N*2];

void add(int u,int v){
    e[++cnt].to = v;
    e[cnt].next = head[u];
    head[u] = cnt;
}

void dfs(int u,int fa) // uä¸ºå½“å‰èŠ‚ç‚¹,faä¸ºçˆ¶èŠ‚ç‚¹
{
    f[u][0] = fa;
    d[u] = d[fa]+1;

    for(int i=1;(1<<i)<=d[u];i++)
        f[u][i] = f[f[u][i-1]][i-1];    //é¢„å¤„ç†fæ•°ç»„

    for(int i=head[u];i!=-1;i=e[i].next){
        int v = e[i].to;
        if(v!=fa)
            dfs(v,u);
    }
}

int lca(int x,int y)
{
    if(d[x]>d[y])  //ä»¤yä¸ºæ›´æ·±èŠ‚ç‚¹
    	swap(x,y);
    
    for(int i=20;i>=0;i--){   //è¿™é‡Œä½¿å¾—xä¸yå¤„äºåŒä¸€æ·±åº¦
        if(d[x]<=d[y]-(1<<i))
            y=f[y][i];
    }

    //ç‰¹åˆ¤
    if(x==y)
        return x;
    
    for(int i=20;i>=0;i--)
    {
        if(f[x][i]==f[y][i])
            continue;              //è¿™é‡Œæ˜¯ä»æœ€è¿œçš„å…¬å…±ç¥–å…ˆå¼€å§‹æ‰¾ï¼Œæ‰€ä»¥éœ€è¦continue
        else
            x=f[x][i],y=f[y][i];   //ä¸Šè·³
    }

    return f[x][0];
}

int main()
{
    memset(head,-1,sizeof(head));
    int a,b;
    scanf("%d%d%d",&n,&m,&s);
    for(int i=1;i<n;i++)
    {
        scanf("%d%d",&a,&b);
        add(a,b);
        add(b,a);                      //æ— å‘å›¾ï¼Œè¦åŠ ä¸¤æ¬¡
    }
    dfs(s,0);

    for(int i=1;i<=m;i++)
    {
        scanf("%d%d",&a,&b);
        printf("%d\n",lca(a,b));
    }

    return 0;
}

```



##### ST+RMQ(åœ¨çº¿)

**å¤æ‚åº¦**

é¢„å¤„ç†ï¼š`O(logn)`

æŸ¥è¯¢ï¼š`O(1)`

æ€»å¤æ‚åº¦ï¼š`O(nlogn+m)`

**åŸç†**

å°†ä¸€æ£µæ ‘è½¬ä¸ºdfsåºåï¼Œä¹Ÿå°±æ˜¯è¯´dfsåºçš„ä¸€æ®µåŒºé—´æ˜¯åŸæ ‘çš„ä¸€æ£µå­æ ‘ã€‚

è€Œè¦æŸ¥æ‰¾ä¸¤ä¸ªç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œåªè¦æ‰¾dfsåºä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´æ·±åº¦æœ€å°çš„é‚£ä¸ªç‚¹å³å¯ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;

const int MAX_N = 500000+7, MAX_M = 500000+7;

int n,m,s;

//dfsåºæ•°ç»„
int tot = 0;
int fir[MAX_N];
int dfn[MAX_N*2];
int d[MAX_N*2];

//STè¡¨æ•°ç»„
int st[20][MAX_N*2];   //stè¡¨
int ist[20][MAX_N*2];  //è®°å½•æœ€å€¼ä¸‹æ ‡
int Log[MAX_N*2];

void getLog()
{
	Log[1] = 0;
	for(int i=2;i<=MAX_N*2;i++)
		Log[i] = Log[i/2]+1;
}

void init()
{
    for(int i=1;i<=tot;i++){
        st[0][i]=d[i];
        ist[0][i] = dfn[i];
    }
    for(int j=1;(1<<j)<=tot;j++){
		for(int i=1;i+(1<<(j-1))<=tot;i++){
            if(st[j-1][i]<st[j-1][i+(1<<(j-1))]){
                st[j][i] = st[j-1][i];
                ist[j][i] = ist[j-1][i];
            }else{
                st[j][i] = st[j-1][i+(1<<(j-1))];
                ist[j][i] = ist[j-1][i+(1<<(j-1))];
            }
        }
    }

    getLog();
}

int Query(int l,int r)
{
	int k=Log[r-l+1];
	int ans;

    if(st[k][l]<st[k][r-(1<<k)+1]) 
        ans = ist[k][l];
    else 
        ans = ist[k][r-(1<<k)+1];

    return ans;
}


int head[MAX_N], cnt=-1;
struct Edge{
    int to , next;
}e[MAX_N*2];

void add(int u,int v){
    e[++cnt].to = v;
    e[cnt].next = head[u];
    head[u] = cnt;
}

void dfs(int u,int dep) // uä¸ºå½“å‰èŠ‚ç‚¹,depä¸ºæ·±åº¦
{
    fir[u] = ++tot;
    dfn[tot] = u;
    d[tot] = dep;

    for(int i=head[u];i!=-1;i=e[i].next){
        int v = e[i].to;
        if(!fir[v]){
            dfs(v,dep+1);
            dfn[++tot]=u;
            d[tot]=dep;
        }
    }
}


int lca(int x,int y)
{
    int l = fir[x] , r = fir[y];
    if(l>r) swap(l,r);
    return Query(l,r);
}


int main()
{
    memset(head,-1,sizeof(head));
    int a,b;
    scanf("%d%d%d",&n,&m,&s);
    for(int i=1;i<n;i++)
    {
        scanf("%d%d",&a,&b);
        add(a,b);
        add(b,a);                      //æ— å‘å›¾ï¼Œè¦åŠ ä¸¤æ¬¡
    }
    dfs(s,0);
    init();

    for(int i=1;i<=m;i++)
    {
        scanf("%d%d",&a,&b);
        printf("%d\n",lca(a,b));
    }

    return 0;
}

```

##### Tarjanï¼ˆç¦»çº¿ï¼‰ å­˜åœ¨é—®é¢˜ï¼Œæ´›è°·æ¨¡æ¿è¿‡ä¸äº†

**æ€è·¯**

+ ä»»é€‰ä¸€ä¸ªç‚¹uä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¼€å§‹éå†
+ éå†æ‰€æœ‰çš„å­èŠ‚ç‚¹vï¼Œå¹¶è¿›è¡Œæ ‡è®°
+ è‹¥æœ‰å­èŠ‚ç‚¹vè¿˜æœ‰å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé‡å¤ç¬¬äºŒæ­¥ï¼Œç»§ç»­éå†
+ åˆå¹¶våˆ°uä¸Šï¼ˆä½¿ç”¨å¹¶æŸ¥é›†ï¼‰
+ å¯»æ‰¾ä¸uæœ‰å…³ç³»çš„æŸ¥è¯¢èŠ‚ç‚¹v
+ è‹¥vå·²è¢«è®¿é—®è¿‡ï¼Œåˆ™å¯ä»¥ç›´æ¥æ±‚å‡ºLCAï¼Œå³ä¸ºvè¢«åˆå¹¶åˆ°çš„çˆ¶äº²ç»“ç‚¹

**ä¼ªä»£ç **ï¼š

```cpp
Tarjan(u)//margeå’Œfindä¸ºå¹¶æŸ¥é›†åˆå¹¶å‡½æ•°å’ŒæŸ¥æ‰¾å‡½æ•°
{
    for each(u,v)    //è®¿é—®æ‰€æœ‰uå­èŠ‚ç‚¹v
    {
        Tarjan(v);        //ç»§ç»­å¾€ä¸‹éå†
        marge(u,v);    //åˆå¹¶våˆ°uä¸Š
        æ ‡è®°vè¢«è®¿é—®è¿‡;
    }
    for each(u,e)    //è®¿é—®æ‰€æœ‰å’Œuæœ‰è¯¢é—®å…³ç³»çš„e
    {
        å¦‚æœeè¢«è®¿é—®è¿‡;
        u,eçš„æœ€è¿‘å…¬å…±ç¥–å…ˆä¸ºfind(e);
    }
}
```

```cpp
void Tarjan(int u,int fa) // uä¸ºå½“å‰èŠ‚ç‚¹,faä¸ºçˆ¶èŠ‚ç‚¹
{

    for(int i=head[u];i!=0;i=e[i].next){
        int v = e[i].to;
        if(v!=fa&&!vis[v]){
            Tarjan(v,u);
            unionn(u,v);   // æ³¨æ„è¿™é‡Œä½ç½®ä¸èƒ½äº¤æ¢ï¼Œ åŸæ ‘ä¸Šuä¸ºvçš„çˆ¶èŠ‚ç‚¹
            vis[v]=true;   // æ ‡è®°è®¿é—®
        }
    }

    for(int i=que[u];i!=0;i=q[i].next){
        int v = q[i].to;
        if(!q[i].flag&&vis[v]){
            ans[q[i].num] = find(v);
            q[i].flag = true;           //å®Œæˆè¯¢é—®åˆ™æŠŠé•œåƒé—®é¢˜ä¹Ÿæ‰“ä¸Šæ ‡è®°
            q[q[i].same].flag = true;
        }
    }
}
```





### æœ€å°ç”Ÿæˆæ ‘

**å®šä¹‰** ï¼šå¯¹å¸¦æƒ**è”é€š**æ— å‘å›¾Gï¼Œç”Ÿæˆä¸€æ£µæƒå€¼æœ€å°çš„æ ‘ã€‚

**æ€§è´¨**ï¼š

+ å¯èƒ½å«æœ‰å¤šä¸ªæœ€å°ç”Ÿæˆæ ‘ï¼Œä½†æ˜¯æœ€å°æƒå€¼ä¹‹å’Œå”¯ä¸€ã€‚
+ è¾¹æ•°=ç‚¹æ•° - 1



#### Prim

**æ€æƒ³** ï¼šä»ä¸€ä¸ªé¡¶ç‚¹å¼€å§‹æ„å»ºï¼Œæ¯æ¬¡å°†èŠ±è´¹æœ€å°çš„æ–°é¡¶ç‚¹åŠ å…¥ï¼Œç›´åˆ°æ‰€æœ‰é¡¶ç‚¹éƒ½åŠ å…¥ã€‚

**æ—¶é—´å¤æ‚åº¦** ï¼š$O(\mid V \mid ^2)$   ï¼Œé€‚ç”¨äºç¨ å¯†å›¾

```cpp
//Prim
int maxn;  //æœ€å¤§ç»“ç‚¹æ•°
int INF = 1000000000;
int dis[maxn]; //é¡¶ç‚¹ä¸é›†åˆä¸­ä»»ä¸€ç‚¹çš„æœ€çŸ­è·ç¦»
bool vus[maxn]; //æ˜¯å¦å·²åŠ å…¥
int Prim()
{
    fill(dis,dis+maxn,INF);   //åˆå§‹åŒ–disæ•°ç»„ä¸ºINF
    dis[0]=0;   //é€‰æ‹©0å·ç»“ç‚¹åŠ å…¥ï¼Œåˆ™åªæœ‰0å·èŠ‚ç‚¹è·ç¦»ä¸º0
    int ans = 0;  //ç”±äºä¸€å¼€å§‹åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œæ²¡æœ‰è¾¹ï¼Œæ‰€ä»¥è¾¹æƒä¹‹å’Œä¸º0
    for(int i=0;i<n;i++)
    {
        int u = -1;
        int minn = INF;
        for(int j=0;j<n;j++)
        {
            if(!vis[j] && dis[j]<minn)  //æ²¡è¢«è®¿é—®è¿‡ä¸”è·ç¦»æœ€çŸ­
            {
                u = j;
                minn = dis[j];
            }
        }
        if(u==-1) //æ²¡æœ‰æ‰¾åˆ°
        	reutnr -1;
       	
        vis[u]=1;
        ans+=dis[u];
        for(int v = 0; v<n; v++)
        {
            if(!vis[v] && a[u][v]!=INF && a[u][v]<dis[v])
            {
                dis[v]=a[u][v];
            }
        }
    }
    
    
}
```




#### Kruskal

**æ€æƒ³** ï¼šæ¯æ¬¡é€‰æ‹©æƒå€¼æœ€å°çš„è¾¹åŠ å…¥ï¼Œä¸”ä¸¤ä¸ªç«¯ç‚¹æ²¡æœ‰è”é€šï¼Œç›´åˆ°æ‰€æœ‰ç»“ç‚¹éƒ½è”é€š

**æ—¶é—´å¤æ‚åº¦** ï¼š$O(\textbar E \textbar log_2\textbar E \textbar)$

```cpp
    //Kruskal

    struct Edge{
        int u;
        int v;
        int w;
    }e[maxm];
    bool cmp(Edge p,Edge q)
    {
        return p.w<q.w;
    }

    int find(int x)
    {

        if(fa[x]!=x)
        {
            fa[x]=find(fa[x]);
        }
        return fa[x];
    }

    void Kruskal()
    {
        sort(e+1,e+m+1,cmp);
        for(int i=1;i<=m;i++)
        {
            int faa = find(e[i].u);
            int fab = find(e[i].v);
            if(faa == fab)
                continue;
            fa[fab]=faa;
            ans+=e[i].w;
            if(++cnt == n-1)
                break;
        }
    }
```

### æ‹“æ‰‘æ’åº

#### æ€è·¯

å°†ä¸€ä¸ªå›¾ä¸­çš„å…¥åº¦ä¸º0çš„ç‚¹é€‰å–å‡ºæ¥ï¼Œç„¶åæŠŠå®ƒæŒ‡å‘ç‚¹æ‰€æœ‰çš„ç‚¹å…¥åº¦å‡ä¸€ï¼Œä¸æ–­é‡å¤è¿™ä¸ªæ“ä½œï¼Œä¾æ¬¡é¡ºåºä¾¿æ˜¯**æ‹“æ‰‘æ’åº**çš„é¡ºåºã€‚

#### å¤æ‚åº¦

`O(V+E)`

```cpp
    queue<int>q;
    vector<int>edge[n];
    for(int i=0;i<n;i++)  //n  èŠ‚ç‚¹çš„æ€»æ•°
        if(in[i]==0) q.push(i);  //å°†å…¥åº¦ä¸º0çš„ç‚¹å…¥é˜Ÿåˆ—
    vector<int>ans;   //ans ä¸ºæ‹“æ‰‘åºåˆ—
    while(!q.empty())
    {
        int p=q.front(); q.pop(); // é€‰ä¸€ä¸ªå…¥åº¦ä¸º0çš„ç‚¹ï¼Œå‡ºé˜Ÿåˆ—
        ans.push_back(p);
        for(int i=0;i<edge[p].size();i++)
        {
            int y=edge[p][i];
            in[y]--;
            if(in[y]==0)
                q.push(y);  
        }
    }
    if(ans.size()==n)   
    {
        for(int i=0;i<ans.size();i++)
            printf( "%d ",ans[i] );
        printf("\n");
    }
    else printf("No Answer!\n");   //  ans ä¸­çš„é•¿åº¦ä¸nä¸ç›¸ç­‰ï¼Œå°±è¯´æ˜æ— æ‹“æ‰‘åºåˆ—

```

### å·®åˆ†çº¦æŸç³»ç»Ÿ

ç”±å¤šä¸ªä¸ç­‰å¼ç»„æˆï¼Œæ¯”å¦‚ `i-j<k` ï¼Œå¯ä»¥å»ºç«‹ä¸€æ¡ä»`j`åˆ°`i`ï¼Œè¾¹é•¿ä¸º`k` çš„è¾¹ã€‚

å…³äºä¸ºä»€ä¹ˆå·®åˆ†çº¦æŸç³»ç»Ÿå¯ä»¥è½¬æ¢ä¸ºæœ€çŸ­è·¯é—®é¢˜ï¼š

[![vcA0Qx.png](https://s1.ax1x.com/2022/08/23/vcA0Qx.png)](https://imgse.com/i/vcA0Qx)

è¦æ»¡è¶³æ‰€æœ‰çš„æ¡ä»¶ï¼Œå› æ­¤ C - A å¯èƒ½åŒæ—¶éœ€è¦æ»¡è¶³å°äº10ï¼Œå°äº5ï¼Œè¿™æ—¶å€™ä¸€å®šè¦æ»¡è¶³å°äº5ï¼Œå¦‚æœå¤§äº5é‚£è¿™ä¸ªæ¡ä»¶å°±ä¸æ»¡è¶³äº†ã€‚

```cpp
bool spfa(int x) {
    dis[x] = 0;
    vis[x] = true;
    q.push(x);
    num[x]++;
    while (!q.empty()) {
        int u = q.front();
        q.pop();
        vis[u] = false;
        for (int i = head[u]; i; i = e[i].nex) {
            int to = e[i].to;
            if (dis[u] + e[i].val < dis[to]) {
                dis[to] = dis[u] + e[i].val;
                if (!vis[to]) {
                    q.push(to);
                    vis[to] = true;
                    num[to]++;
                    if (num[to] == n + 1)return false;  //åˆ¤æ–­æ˜¯å¦æœ‰è´Ÿç¯ï¼Œå¦‚æœæœ‰è´Ÿç¯åˆ™å…¥é˜Ÿæ¬¡æ•°>nï¼Œåˆ™æ— è§£ã€‚
                }
            }
        }
    }
    return true;
}
```



### è¿é€šæ€§

[åšå®¢](https://blog.csdn.net/qq_25930891/article/details/123208901)

**å¼ºè¿é€šåˆ†é‡**

åœ¨ä¸€ä¸ªå›¾Gä¸­ï¼Œè‹¥ä¸¤ä¸ªç‚¹äº’ç›¸å¯åˆ°è¾¾ï¼Œåˆ™ç§°è¯¥ä¸¤ç‚¹**å¼ºè¿é€š**ï¼Œè‹¥è¯¥å›¾ä¸­æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´éƒ½æ˜¯å¼ºè¿é€šï¼Œåˆ™è¯¥å›¾ä¸ºä¸€ä¸ª**å¼ºè¿é€šå›¾**ã€‚

æœ‰å‘éå¼ºè¿é€šå›¾çš„æå¤§å¼ºè¿é€šå­å›¾ï¼Œç§°ä¸º**å¼ºè¿é€šåˆ†é‡** ã€‚

**ä½œç”¨**

é™ä½å›¾çš„è§„æ¨¡ï¼Œä»è€Œå‡å°å›¾çš„å¤æ‚åº¦ã€‚

#### Tarjanç®—æ³•

å¯ä»¥æ‰¾å‡ºä¸€ä¸ªå›¾ä¸­æ‰€æœ‰çš„å¼ºè¿é€šåˆ†é‡ã€‚

ä¸æ–­`dfs`æœç´¢ï¼Œé‡åˆ°ç¯åˆ™è¿›è¡Œæ›´æ–°ï¼Œç„¶åè¿”å›ã€‚

```cpp
void tarjan(int x) {
    s.push(x);
    instack[x] = 1;	
    
    dfn[x] = low[x] = ++cnt; //åˆå§‹åŒ–dfnå’Œlow
    
    //æ ¸å¿ƒä»£ç ï¼Œæ·±æœè¿™ä¸ªç‚¹
    for (int i = head[x]; i; i = edge[i].next) {
        int to = edge[i].to;
        if(!dfn[to]){	//å¦‚æœä¸‹ä¸€ä¸ªç‚¹æ²¡æœ‰è¢«æœè¿‡ï¼Œ
            tarjan(to);	//ç»§ç»­æ·±æœ
            low[x] = min(low[x], low[to]); //æ›´æ–°low
        }
        else if(instack[to]){ //å¦‚æœä¸‹ä¸€ä¸ªç‚¹å·²ç»è¢«æœè¿‡ï¼Œçœ‹ä»–åœ¨ä¸åœ¨æ ˆé‡Œ
            low[x] = min(low[x], dfn[to]); //æ›´æ–°low
        }
    }
    //å¦‚æœdfn==lowï¼Œå³æ‰¾å®Œäº†ä¸€æ•´å—å¼ºè¿é€šåˆ†é‡ï¼Œå‡ºæ ˆ+æ ‡è®°
    if(dfn[x] == low[x]){
        tot++;//è®¡æ•°å™¨++ï¼Œç¬¬å‡ ä¸ªå¼ºè¿é€šåˆ†é‡
        while(s.top()!=x){ 		//ä¸åŠ 1çš„è¯xè¿™ä¸ªç‚¹ä¸ä¼šè¢«å‡ºæ ˆ
            scc[s.top()] = tot;	//æ‰“æ ‡è®°
            instack[s.top()]=0;
            s.pop();//å‡ºæ ˆ
        }
    }
}


```



#### ç¼©ç‚¹

[åšå®¢](https://blog.csdn.net/ez_gsn/article/details/122898581?spm=1001.2101.3001.6650.7&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-122898581-blog-93732524.pc_relevant_multi_platform_featuressortv2dupreplace&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-122898581-blog-93732524.pc_relevant_multi_platform_featuressortv2dupreplace&utm_relevant_index=8)

å°±æ˜¯æŠŠåŸæœ¬çš„ç¯ç¼©åˆ°ä¸€ä¸ªç‚¹ä¸Šï¼Œè¿™æ ·çš„è¯å›¾ä¸­æ‰€æœ‰çš„ç¯éƒ½æ¶ˆå¤±äº†

```cpp
void search (int u)
{
	if (f[u]) return;
	f[u] = sum[u];
	int maxsum = 0;
	for (int i = hd[u]; i; i = e[i].nxt)
	{
		int v = e[i].to;
		if (!f[v]) search (v);
		maxsum = max (maxsum, f[v]);
	}
	f[u] += maxsum;
}


```



#### å‰²ç‚¹

âš ï¸ ä»…é’ˆå¯¹æ— å‘å›¾

**è¿é€š** ï¼šå›¾ä¸­ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´å¯äº’ç›¸åˆ°è¾¾

**å‰²ç‚¹**ï¼šåœ¨ä¸€ä¸ª**æ— å‘å›¾**é‡Œï¼Œå»æ‰ä¸€ä¸ªé¡¶ç‚¹ï¼ŒåŠå…¶å»æ‰è¯¥ç‚¹çš„æ‰€æœ‰è¾¹,å‰©ä¸‹çš„å›¾ä¸è¿é€šï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹å°±æ˜¯ä¸ª**å‰²ç‚¹**ã€‚

**å‰²è¾¹**ï¼šåœ¨ä¸€ä¸ª**æ— å‘å›¾**é‡Œï¼Œå»æ‰ä¸€æ¡è¾¹ï¼Œå›¾å°±ä¸è¿é€šäº†ã€‚

```cpp
#include <iostream>

using namespace std;
const int maxn = 1000005;
int low[maxn], dfn[maxn], head[maxn];
bool f[maxn];
int n, m, ans, cnt, id;
struct Edge {
    int to;
    int nex;
} e[maxn << 1];

void add(int x, int y) {
    e[++cnt].to = y;
    e[cnt].nex = head[x];
    head[x] = cnt;
}

void dfs(int u, int root) {
    low[u] = dfn[u] = ++id;
    int tot = 0;
    for (int i = head[u]; i; i = e[i].nex) {
        int v = e[i].to;
        if (!dfn[v]) {
            dfs(v, root);
            low[u] = min(low[u], low[v]);
            if (low[v] >= dfn[u] && u != root)
                f[u] = true;
            if (u == root) tot++;
        }
        low[u] = min(low[u], dfn[v]);

    }
    if (tot >= 2 && root == u)
        f[root] = true;
}

int main() {
    cin >> n >> m;
    int x, y;
    for (int i = 1; i <= m; i++) {
        cin >> x >> y;
        add(x, y);
        add(y, x);
    }
    for (int i = 1; i <= n; i++) {
        if (!dfn[i])
            dfs(i, i);
    }
    for (int i = 1; i <= n; i++)
        if (f[i])
            ans++;
    cout << ans<<endl;
    for (int i = 1; i <= n; i++)
        if (f[i])
            cout << i << ' ';
}
```



### äºŒåˆ†å›¾

[åšå®¢](https://blog.csdn.net/weixin_51797626/article/details/122129473)

**å®šä¹‰**

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€å¼ å›¾ä¸­çš„æ‰€æœ‰çš„ç‚¹èƒ½åˆ†æˆä¸¤ä¸ªé›†åˆï¼Œé›†åˆå†…éƒ¨çš„ç‚¹ä¹‹é—´æ²¡æœ‰è¾¹ï¼Œåªæœ‰å±äºä¸¤ä¸ªä¸åŒçš„é›†åˆçš„ç‚¹æ‰å¯èƒ½å­˜åœ¨è¾¹ï¼Œè¿™æ ·çš„å›¾å«åš**äºŒåˆ†å›¾**

[![vbid91.png](https://s1.ax1x.com/2022/09/07/vbid91.png)](https://imgse.com/i/vbid91)

**æœ€å¤§åŒ¹é…æ•°** ï¼šä¸¤ä¸ªé›†åˆåˆ†åˆ«é€‰ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸¤ä¸ªç‚¹ä¹‹é—´æœ‰è¾¹å°±ç¡®è®¤ä¸€æ®µå…³ç³»ï¼ˆä¸€ä¸ªé›†åˆä¸­çš„ä¸¤ç‚¹ å æœ‰ å¦ä¸€é›†åˆä¸­åŒä¸€ä¸ªç‚¹ æ˜¯ä¸åˆæ³•çš„ï¼‰ï¼Œæœ€å¤šçš„å…³ç³»æ•°é‡å°±æ˜¯è¿™å¼ äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…

**æœ€å°ç‚¹è¦†ç›–**ï¼šåœ¨ä¸€ä¸ªå›¾ä¸­é€‰å–æœ€å°‘ä¸ªç‚¹ï¼Œä½¿å¾—å…¶ä»–æ‰€æœ‰çš„è¾¹éƒ½ä¸é€‰ä¸­çš„ç‚¹ç›¸è¿

 ------------**æœ€å¤§åŒ¹é…æ•° == æœ€å°ç‚¹è¦†ç›–** ---------------



#### åŒˆç‰™åˆ©ç®—æ³•--æ— æƒå€¼æœ€å¤§åŒ¹é…

æ—¶é—´å¤æ‚åº¦ï¼š`O(nm)`

æœ¬è´¨ï¼šå¯»æ‰¾å¢å¹¿è·¯ä»¥è¾¾åˆ°æœ€å¤§åŒ¹é…æƒ…å†µ

```cpp
bool dfs(int x)
{
    for (int i = 1; i <= n; i++)   //éå†å·¦è¾¹é›†åˆæ‰€æœ‰ç‚¹
    {
        if (!vis[i] && match[i][x])  //å¦‚æœå­˜åœ¨è¾¹å¹¶ä¸”è¯¥ç‚¹æ²¡æœ‰è®¿é—®è¿‡ï¼Œé‚£ä¹ˆå°±è¿›è¡Œæ“ä½œ
        {
            vis[i] = 1;             //æ ‡è®°è¯¥ç‚¹ä¸ºå·²è®¿é—®
            if (id[i] == 0 || dfs(id[i]))  //å¦‚æœè¯¥ç‚¹ä¹‹å‰æ²¡æœ‰è¾¹è¿æ¥ï¼Œé‚£ä¹ˆå°±è¿æ¥ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œdfsè¿™ä¸ªç‚¹ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½å¤Ÿæ‰¾åˆ°å…¶ä»–çš„å¢å¹¿è·¯
            {
                id[i] = x;
                return true;
            }
        }
    }
    return false;
}
```







### ç½‘ç»œæµ

[![vLNFJJ.png](https://s1.ax1x.com/2022/09/09/vLNFJJ.png)](https://imgse.com/i/vLNFJJ)

#### æœ€å¤§æµ

##### **Dinic**

æ—¶é—´å¤æ‚åº¦ï¼š$O(v^2e)$

**æ€è·¯** ï¼šå…ˆç”¨`BFS` åˆ†å±‚ï¼Œé¢„å¤„ç†å‡ºæºç‚¹åˆ°æ¯ä¸ªç‚¹çš„è·ç¦»ï¼ˆæ³¨æ„æ¯æ¬¡å¾ªç¯éƒ½è¦é¢„å¤„ç†ä¸€æ¬¡ï¼Œå› ä¸ºæœ‰äº›è¾¹å¯èƒ½å®¹é‡å˜ä¸º0ä¸èƒ½å†èµ°ï¼‰ï¼Œå†ä½¿ç”¨**å¤šè·¯å¢å¹¿** èŠ‚çœèŠ±åœ¨é‡å¤è·¯å¾„ä¸Šçš„æ—¶é—´ï¼ˆåœ¨æŸç‚¹`DFS`æ‰¾åˆ°ä¸€æ¡å¢å¹¿è·¯ä¹‹åï¼Œå¦‚æœè¿˜å‰©ä¸‹å¤šä½™çš„æµé‡æ²¡æœ‰ç”¨ï¼Œç»§ç»­åœ¨è¿™ä¸ªç‚¹`DFS`å°è¯•å¯»æ‰¾æ›´å¤šå¢å¹¿è·¯ã€‚

**å½“å‰å¼§ä¼˜åŒ–** ï¼šåœ¨**Dinic**ç®—æ³•ä¸­ï¼Œä¸€æ¡è¾¹å¢å¹¿ä¸€æ¬¡åå°±ä¸ä¼šå†æ¬¡å¢å¹¿äº†ï¼Œæ‰€ä»¥ä¸‹æ¬¡å¢å¹¿æ—¶ä¸éœ€è¦å†è€ƒè™‘è¿™æ¡è¾¹ã€‚æˆ‘ä»¬æŠŠ`head`æ•°ç»„å¤åˆ¶ä¸€ä»½ï¼Œä½†ä¸æ–­æ›´æ–°å¢å¹¿çš„èµ·ç‚¹ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long LL;

const int N = 10010, E = 200010;

int n, m, s, t; LL ans = 0;
LL cnt = 1, first[N], nxt[E], to[E], val[E];
inline void addE(int u, int v, LL w) {
	to[++cnt] = v;
	val[cnt] = w;
	nxt[cnt] = first[u];
	first[u] = cnt;
}
int dep[N], q[N], l, r;
bool bfs() {//é¡ºç€æ®‹é‡ç½‘ç»œï¼Œæ–¹æ³•æ˜¯ bfsï¼›è¿™æ˜¯ä¸ªboolå‹å‡½æ•°ï¼Œè¿”å›æ˜¯å¦æœåˆ°äº†æ±‡ç‚¹ 
	memset(dep, 0, (n + 1) * sizeof(int));//è®°å¾—å¼€å±€å…ˆåˆå§‹åŒ– 

	q[l = r = 1] = s;
	dep[s] = 1;
	while(l <= r) {
		int u = q[l++];
		for(int p = first[u]; p; p = nxt[p]) {
			int v = to[p];
			if(val[p] and !dep[v]) {//æŒ‰ç…§æœ‰æ®‹é‡çš„è¾¹æœè¿‡å» 
				dep[v] = dep[u] + 1;
				q[++r] = v;
			}
		}
	}
	return dep[t];//dep[t] != 0ï¼Œå°±æ˜¯æœåˆ°äº†æ±‡ç‚¹ 
}
LL dfs(int u, LL in/*uæ”¶åˆ°çš„æ”¯æŒï¼ˆä¸ä¸€å®šèƒ½çœŸæ­£ç”¨æ‰ï¼‰*/) {
//æ³¨æ„ï¼Œreturn çš„æ˜¯çœŸæ­£è¾“å‡ºçš„æµé‡
	if(u == t)
		return in;//åˆ°è¾¾æ±‡ç‚¹æ˜¯ç¬¬ä¸€ä¸ªæœ‰æ•ˆreturn 
	LL out = 0;
	for(int p = first[u]; p and in; p = nxt[p]) {
		int v = to[p];
		if(val[p] and dep[v] == dep[u] + 1) {//ä»…å…è®¸æµå‘ä¸‹ä¸€å±‚ 
			LL res = dfs(v, min(val[p], in)/*å—ä¸€è·¯ä¸Šæœ€å°æµé‡é™åˆ¶*/);
			//resæ˜¯vçœŸæ­£è¾“å‡ºåˆ°æ±‡ç‚¹çš„æµé‡
			val[p] -= res;
			val[p ^ 1] += res;
			in -= res;
			out += res;
		}
	}
	if(out == 0)//æˆ‘ä¸ç»ˆç‚¹ï¼ˆé¡ºç€æ®‹é‡ç½‘ç»œï¼‰ä¸è¿é€š 
		dep[u] = 0;//ä¸Šä¸€å±‚çš„ç‚¹è¯·åˆ«å†ä¿¡ä»»æˆ‘ï¼Œåˆ«è¯•ç€ç»™æˆ‘æµé‡
	return out;
}
int main() {
	scanf("%d %d %d %d", &n, &m, &s, &t);
	for(int i = 1; i <= m; ++i) {
		int u, v; LL w;
		scanf("%d %d %lld", &u, &v, &w);
		addE(u, v, w);
		addE(v, u, 0);
	}
	while(bfs()) 
		ans += dfs(s, 1e18);
	printf("%lld\n", ans);
	return 0;
}
```



##### é¢„æµæ¨è¿›--HLPP

HLPP--- æœ€é«˜æ ‡å·é¢„æµæ¨è¿›ç®—æ³•





#### æœ€å°å‰²

**å‰²**ï¼šä»ç½‘ç»œä¸­é€‰æ‹©ä¸€äº›è¾¹ï¼Œä½¿å¾—å»æ‰è¿™äº›è¾¹åï¼Œå‰©ä¸‹ä¸¤ä¸ªä¸è¿é€šçš„åˆ†åˆ«åŒ…å«æºç‚¹å’Œæ±‡ç‚¹çš„ç‚¹é›†ã€‚å»æ‰çš„è¿™äº›è¾¹çš„æƒå€¼ä¹‹å’Œå°±æ˜¯**å‰²**ã€‚

:star:**æœ€å¤§æµ=æœ€å°å‰²**



#### è´¹ç”¨æµ



#### ä¸Šä¸‹ç•Œç½‘ç»œæµ







### æ ‘é“¾å‰–åˆ†

[![volCWQ.png](https://s1.ax1x.com/2022/09/03/volCWQ.png)](https://imgse.com/i/volCWQ)

**ä½¿ç”¨åœºæ™¯**

+ ä»å­èŠ‚ç‚¹åˆ°æ ¹ç»“ç‚¹åˆ°è·¯ç¨‹ä¸­ æ“ä½œ
+ ä»æ ¹èŠ‚ç‚¹åˆ°å…¶æ‰€æœ‰å­èŠ‚ç‚¹ æ“ä½œ

æ¦‚å¿µï¼š**é‡å„¿å­** --- ä¸€ä¸ªèŠ‚ç‚¹ä¸­å­æ ‘æœ€å¤§çš„å„¿å­ã€‚

**å®ç°**

**DFS1**

å¤„ç†äº‹æƒ…ï¼š

+ æ ‡è®°æ¯ä¸ªç‚¹çš„æ·±åº¦`deep`
+ æ ‡è®°æ¯ä¸ªç‚¹çš„çˆ¶äº²`fa`
+ æ ‡è®°æ¯ä¸ªç‚¹éå¶å­ç»“ç‚¹çš„å­æ ‘å¤§å°ï¼ˆåŒ…å«è‡ªèº«ï¼‰`size`
+ æ ‡è®°æ¯ä¸ªéå¶å­ç»“ç‚¹çš„é‡å„¿å­`son`

```cpp
void dfs1(int x, int f, int deep)
{                    // xå½“å‰èŠ‚ç‚¹ï¼Œfçˆ¶äº²ï¼Œdeepæ·±åº¦
    dep[x] = deep;   //æ ‡è®°æ¯ä¸ªç‚¹çš„æ·±åº¦
    fa[x] = f;       //æ ‡è®°æ¯ä¸ªç‚¹çš„çˆ¶äº²
    siz[x] = 1;      //æ ‡è®°æ¯ä¸ªéå¶å­èŠ‚ç‚¹çš„å­æ ‘å¤§å°
    int maxson = -1; //è®°å½•é‡å„¿å­çš„å„¿å­æ•°
    for (int i = head[x]; i; i = e[i].nex)
    {
        int y = e[i].to;
        if (y == f)
            continue;         //è‹¥ä¸ºçˆ¶äº²åˆ™continue
        dfs1(y, x, deep + 1); // dfså…¶å„¿å­
        size[x] += size[y];     //æŠŠå®ƒçš„å„¿å­æ•°åŠ åˆ°å®ƒèº«ä¸Š
        if (size[y] > maxson)
            son[x] = y, maxson = size[y]; //æ ‡è®°æ¯ä¸ªéå¶å­èŠ‚ç‚¹çš„é‡å„¿å­ç¼–å·
    }
} //å˜é‡è§£é‡Šè§æœ€ä¸‹é¢
```

**DFS2**ï¼š

å¤„ç†äº‹æƒ…ï¼š

+ æ ‡è®°æ¯ä¸ªç‚¹çš„æ–°ç¼–å·
+ å°†æ¯ä¸ªç‚¹çš„åˆå§‹å€¼èµ‹ç»™æ–°ç¼–å·
+ å¤„ç†æ¯ä¸ªç‚¹æ‰€åœ¨çš„æœ€é¡¶ç«¯
+ å¤„ç†æ¯æ¡é“¾

```cpp
void dfs2(int x, int topf)
{                   // xå½“å‰èŠ‚ç‚¹ï¼Œtopfå½“å‰é“¾çš„æœ€é¡¶ç«¯çš„èŠ‚ç‚¹
    id[x] = ++cnt;  //æ ‡è®°æ¯ä¸ªç‚¹çš„æ–°ç¼–å·
    wt[cnt] = w[x]; //æŠŠæ¯ä¸ªç‚¹çš„åˆå§‹å€¼èµ‹åˆ°æ–°ç¼–å·ä¸Šæ¥
    top[x] = topf;  //è¿™ä¸ªç‚¹æ‰€åœ¨é“¾çš„é¡¶ç«¯
    if (!son[x])
        return;         //å¦‚æœæ²¡æœ‰å„¿å­åˆ™è¿”å›
    dfs2(son[x], topf); //æŒ‰å…ˆå¤„ç†é‡å„¿å­ï¼Œå†å¤„ç†è½»å„¿å­çš„é¡ºåºé€’å½’å¤„ç†
    for (int i = head[x]; i; i = e[i].nex)
    {
        int y = e[i].to;
        if (y == fa[x] || y == son[x])
            continue;
        dfs2(y, y); //å¯¹äºæ¯ä¸€ä¸ªè½»å„¿å­éƒ½æœ‰ä¸€æ¡ä»å®ƒè‡ªå·±å¼€å§‹çš„é“¾
    }
} //å˜é‡è§£é‡Šè§æœ€ä¸‹é¢
```

å»ºä¸€æ£µæ ‘ç»´æŠ¤å®ƒä»¬ï¼š

```cpp
void build(int k, int l, int r)
{
    if (l == r)
    {
        t[k] = w[l];
        t[k] %= mod;
        return;
    }
    ll mid = (l + r) >> 1;
    build(k << 1, l, mid);
    build(k << 1 | 1, mid + 1, r);
    t[k] = (t[k << 1] + t[k << 1 | 1]) % mod;
}
```

**å¸¸è§æ“ä½œ**

**ä¿®æ”¹**ï¼šä»`x` åˆ°`y` çš„æœ€çŸ­è·¯å¾„æ‰€æœ‰ç»“ç‚¹åŠ ä¸Š`z`

```cpp
void updRange(int x, int y, int k)
{
    k %= mod;
    while (top[x] != top[y])  //å½“ä¸¤ä¸ªç‚¹ä¸åœ¨åŒä¸€æ¡é‡é“¾
    {
        if (deep[top[x]] < deep[top[y]])
            swap(x, y);
        update(1, 1, n, id[top[x]], id[x], k);
        x = fa[top[x]];
    }
    //å½“ä¸¤ä¸ªç‚¹åœ¨åŒä¸€æ¡é‡é“¾
    if (deep[x] > deep[y])
        swap(x, y);
    update(1, 1, n, id[x], id[y], k);
}
```



**æŸ¥è¯¢**ï¼šæ±‚ä»`x`åˆ°`y`ç»“ç‚¹æœ€çŸ­è·¯å¾„æ‰€æœ‰ç»“ç‚¹ä¹‹å’Œ

æ¯æ¬¡æŸ¥è¯¢å¤æ‚åº¦ï¼š$O(log^2n)$

```cpp
ll qRange(int x, int y)
{
    ans = 0;
    while (top[x] != top[y]) //å½“ä¸¤ä¸ªç‚¹ä¸åœ¨åŒä¸€æ¡é“¾ä¸Š
    {
        if (deep[top[x]] < deep[top[y]])
            swap(x, y); //æŠŠxç‚¹æ”¹ä¸ºæ‰€åœ¨é“¾é¡¶ç«¯çš„æ·±åº¦æ›´æ·±çš„é‚£ä¸ªç‚¹
        res = 0;
        ask(1, 1, n, id[top[x]], id[x]); // ansåŠ ä¸Šxç‚¹åˆ°xæ‰€åœ¨é“¾é¡¶ç«¯ è¿™ä¸€æ®µåŒºé—´çš„ç‚¹æƒå’Œ
        ans += res;
        ans %= mod;     //æŒ‰é¢˜æ„å–æ¨¡
        x = fa[top[x]]; //æŠŠxè·³åˆ°xæ‰€åœ¨é“¾é¡¶ç«¯çš„é‚£ä¸ªç‚¹çš„ä¸Šé¢ä¸€ä¸ªç‚¹
    }
    //ç›´åˆ°ä¸¤ä¸ªç‚¹å¤„äºä¸€æ¡é“¾ä¸Š
    if (deep[x] > deep[y])
        swap(x, y); //æŠŠxç‚¹å˜æˆæ·±åº¦æ›´å°çš„é‚£ä¸ªç‚¹
    res = 0;
    ask(1, 1, n, id[x], id[y]); //è¿™æ—¶å†åŠ ä¸Šæ­¤æ—¶ä¸¤ä¸ªç‚¹çš„åŒºé—´å’Œå³å¯
    ans += res;
    ans %= mod;
    return ans % mod;
}
```



**æ”¹å˜å­æ ‘**ï¼šæ›´æ”¹ä»¥`x`ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹çš„å’Œ

```cpp
void updSon(int x, int k)
{
    update(1, 1, n, id[x], id[x] + size[x] - 1, k);
}
```



**æ±‚å­æ ‘å’Œ**ï¼šæ±‚ä»¥`x`ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹çš„å’Œ

```cpp
ll qSon(int x)
{
    res = 0;
    ask(1, 1, n, id[x], id[x] + size[x] - 1); //å­æ ‘åŒºé—´å³ç«¯ç‚¹ä¸ºid[x]+size[x]-1
    return
```



### æ ‘ä¸Škçº§ç¥–å…ˆ

å¯¹ä¸€æ£µæ ‘æ±‚å‡ºæŸä¸ªç»“ç‚¹çš„kçº§ç¥–å…ˆã€‚

**æ€è·¯** ï¼šç±»ä¼¼äºå€å¢ï¼Œæ¯”å¦‚ k = 37ï¼Œå¯ä»¥ç”¨ `k=32+4+1`çš„æ–¹æ³•å¤„ç†ã€‚

**é¢„å¤„ç†**

```cpp
void dfs(int u, int fa)   
{
    depth[u] = depth[fa] + 1;  //å¤„ç†æ·±åº¦
    f[u][0] = fa;              //è¯¥èŠ‚ç‚¹ï¼ˆuï¼‰çš„ç¬¬ä¸€ä¸ªçˆ¶èŠ‚ç‚¹å°±æ˜¯ fa
    for (int i = 1; i <= 20; i++)
    {
        f[u][i] = f[f[u][i - 1]][i - 1];    //è½¬ç§»
    }
    for (auto &to : e[u])  //dfså¤„ç†
    {
        if (to != fa)
            dfs(to, u);
    }
}
```

**å®ç°**

```cpp
int getk(int x,int k) 
{
    if(!k)         //å¦‚æœk=0ï¼Œè¯´æ˜å®ƒçš„0çº§ç¥–å…ˆå°±æ˜¯å®ƒæœ¬èº«
        return x;
    int index= log2(k);   //log2å‡½æ•°
    return getk(f[x][index], k - (1 << index));
}
```



### æ‰«æçº¿

#### å®šä¹‰

åœ¨åŒä¸€ä¸ªçŸ©å½¢å†…ï¼Œä»å·¦å¾€å³çœ‹ï¼Œç¬¬ä¸€æ¡çœ‹åˆ°çš„è¾¹ä¸ºâ€œå…¥è¾¹â€ï¼Œç¬¬äºŒæ¡çœ‹åˆ°çš„è¾¹ä¸ºâ€œå‡ºè¾¹â€ã€‚









### ç‰¹å¼‚æ ‘å½¢

#### åŸºç¯æ ‘

å¯¹äºä¸€æ£µæ ‘æ¥è¯´ï¼Œæœ‰`n`ä¸ªç‚¹ï¼Œåªèƒ½æœ‰`n-1`æ¡è¾¹ï¼Œä½†æ˜¯**åŸºç¯æ ‘**æœ‰`n`æ¡è¾¹ï¼Œå› æ­¤å½¢æˆäº†ä¸€ä¸ªç¯

â“é‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿ

ğŸŒŸåˆ æ‰ä¸€æ¡è¾¹ï¼ä½¿å®ƒæˆä¸ºä¸€æ£µæ ‘ã€‚

ä¸æ–­åŠ è¾¹ï¼Œå¹¶ä¸”ç”¨å¹¶æŸ¥é›†çš„æ€æƒ³åˆ¤æ–­ï¼Œå¦‚æœåŠ çš„é‚£æ¡è¾¹çš„ä¸¤ä¸ªèŠ‚ç‚¹åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œé‚£ä¹ˆè¯´æ˜å·²ç»å­˜åœ¨ä¸€ä¸ªç¯ï¼Œé‚£ä¹ˆä¸è¦æŠŠè¿™æ¡è¾¹åŠ è¿›å»å³å¯ï¼Œç›¸å½“äºåˆ é™¤äº†ä¸€æ¡è¾¹ã€‚

```cpp
 for (int i = 1; i <= n; i++)
    {
        cin >> u >> v;
        u += 1;
        v += 1;
        if (find(u) == find(v))
        {
            S = u;
            T = v;
            continue;
        }
        add(u, v);
        add(v, u);
        fa[find(v)] = find(u);
    }
```





## æ•°è®º

### ç­›æ³•

#### ç´ æ•°ç­›æ³•

##### çº¿æ€§ç­›ï¼ˆæœ€å¿«ï¼‰

æ—¶é—´å¤æ‚åº¦ï¼šO(n)

```cpp
int Mark[MAXSIZE];  
int prime[MAXSIZE];  

//åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªç´ æ•°  Mark æ ‡è®°æ•°ç»„ index ç´ æ•°ä¸ªæ•°  
int Prime(){  
    int index = 0;  
    for(int i = 2; i < MAXSIZE; i++){  
        //å¦‚æœæœªæ ‡è®°åˆ™å¾—åˆ°ä¸€ä¸ªç´ æ•°  
        if(Mark[i] == 0) prime[++index] = i;  
        //æ ‡è®°ç›®å‰å¾—åˆ°çš„ç´ æ•°çš„iå€ä¸ºéç´ æ•°  
        for(int j = 1; j <= index && prime[j] * i < MAXSIZE; j++){  
            Mark[i * prime[j]] = 1;  
            if(i % prime[j] == 0) break;  
        }  
    }  
    return index;  
}
```



##### æ¬§æ‹‰ç­›

**æ—¶é—´å¤æ‚åº¦ï¼šO(n)**

**åŸç†**ï¼šå¦‚æœåˆ¤æ–­24æ˜¯å¦ä¸ºä¸€ä¸ªç´ æ•°é‚£ä¹ˆç”¨åŸƒæ°ç­›çš„è¯èµ·ç ä¼šé‡å¤ç­›24ä¸‰æ¬¡ï¼ˆ2\*12ï¼Œ3\*8ï¼Œ4\*6ï¼‰ï¼Œé‚£æ¬§æ‹‰ç­›å°±æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šåªç­›ä¸€æ¬¡å°±æ˜¯å…¶æœ€å°è´¨å› æ•°ä¸å› ä¸€ä¸ªåˆæ•°çš„ä¹˜ç§¯ã€‚

```cpp
#include <bits/stdc++.h>//æ¬§æ‹‰ç­›

using namespace std;
bool A[100000001];
int prime[1000001];

int main() {
    int n, m;
    scanf("%d %d", &n, &m);
    int cnt = 0;
    for (int i = 2; i <= n; i++) {
        if (A[i] == false) {
            prime[++cnt] = i;
        }
        for (int j = 1; j <= cnt && i * prime[j] <= n; j++) {
            A[i * prime[j]] = true;
            if (i % prime[j] == 0) break;//æœ€é‡è¦çš„ä¸€æ­¥
        }
    }
    for (int i = 0; i < m; i++) {
        int c;
        scanf("%d", &c);
        printf("%d\n", prime[c]);
    }
    return 0;
}
```





### æ•´é™¤ç›¸å…³

#### Pollard-Rhoç®—æ³•

ç”¨äºå¯¹å¤§æ•°è¿›è¡Œè´¨å› æ•°åˆ†è§£ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º`O()`









#### æ¬§æ‹‰å‡½æ•°

å¯¹æ­£æ•´æ•°nï¼Œæ¬§æ‹‰å‡½æ•° $Ï†(n)$ æ˜¯å°äºnçš„æ­£æ•´æ•°ä¸­ä¸näº’è´¨çš„æ•°çš„æ•°ç›®ã€‚

```cpp
typedef long long ll;
ll Eular(ll n)
{
    ll ans=n;
    for(int i=2; i*i <= n; ++i)
    {
        if(n%i == 0)
        {
            ans = ans/i*(i-1);
            while(n%i == 0)
                n/=i;
        }
    }
    if(n > 1) ans = ans/n*(n-1);
    return ans;
}
```

è‹¥nä¸ºè´¨æ•°ï¼Œåˆ™ $Ï†(n) = n-1$ 



### åŒä½™æ–¹ç¨‹

#### çº¿æ€§åŒä½™æ–¹ç¨‹



#### ä¹˜æ³•é€†å…ƒ

**å®šä¹‰**

â€‹	è‹¥**a**ä¸**p**äº’è´¨ a * b = 1 (mod p) --> aä¸bçš„ä¹˜ç§¯åœ¨æ¨¡pæ—¶æ’ç­‰äº1ï¼Œåˆ™bæ˜¯aåœ¨æ¨¡pæƒ…å†µä¸‹çš„é€†å…ƒ

â€‹	å¯ä»¥æ ¹æ®ä¹˜æ³•é€†å…ƒï¼Œå°† (a / b) % c è½¬åŒ–ä¸º (a * x) % c ï¼Œå°†é™¤æ³•è½¬åŒ–ä¸ºä¹˜æ³•ã€‚

**è§£æ³•**

**è´¹é©¬å°å®šç†**

â€‹	å‡å¦‚pæ˜¯è´¨æ•°ï¼Œä¸”$gcd(a,p)=1$ï¼Œé‚£ä¹ˆ $a^ {p-1}â‰¡1(mod p)$ ã€‚

â€‹	æ ¹æ®è´¹é©¬å°å®šç†ï¼Œa çš„é€†å…ƒå³ä¸º $a^{p-2}$

```cpp
éœ€è¦ç»“åˆå¿«é€Ÿå¹‚
ll fpm(ll x, ll power, ll mod) {
    x %= mod;
    ll ans = 1;
    for (; power; power >>= 1, (x *= x) %= mod)
    	if(power & 1) (ans *= x) %= mod;
    return ans;
}
int main() {
	ll x = fpm(a, p - 2, p); //xä¸ºaåœ¨mod pæ„ä¹‰ä¸‹çš„é€†å…ƒ
}
```



**æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†**

â€‹	å¿…å­˜åœ¨ x y ï¼Œæ»¡è¶³ç­‰å¼ a*x + b*y = gcd(a,b)  å› æ­¤ï¼Œè‹¥gcd(a,b)=1ï¼Œåˆ™å¯ä»¥æ±‚ä¹˜æ³•é€†å…ƒ

å¯é€’å½’å¾—å‡ºç»“è®ºï¼š` x = y' ,y = x'- a/b * y'`

```cpp
void exgcd(ll a, ll b, ll &x, ll &y)
{
    if (!b) //é€’å½’åˆ°ç‰¹è§£å¼€å§‹å›æº¯
    {
        x = 1;
        y = 0;
        return;
    }
    exgcd(b, a % b, x, y); //æ±‚å¾—x2,y2
    ll temp = x;
    x = y;                  //å›æº¯ï¼Œåˆ©ç”¨x2é€’æ¨x1
    y = temp - (a / b) * y; //å›æº¯ï¼Œåˆ©ç”¨y2é€’æ¨y1
}
int main()
{
    ll a, b, x, y;
    cin >> a >> b;
    exgcd(a, b, x, y);
    cout << x << ' ' << y << endl;
    return 0;
}
```

**é€’æ¨å…¬å¼**

ä»ä¸€åˆ°nçš„é€†å…ƒï¼š

è¿™ä¸ªå¼å­å¿…é¡»ä»1å¼€å§‹é€’æ¨

![image.png](https://s2.loli.net/2022/08/20/MLnIpJgbjHkRP7Y.png)





#### ä¸­å›½å‰©ä½™å®šç†(CRT)

> è¢«3é™¤å‰©2ï¼Œè¢«5é™¤å‰©3ï¼Œè¢«7é™¤å‰©2ï¼Œé—®è¯¥æ•°ä¸ºå¤šå°‘ï¼Ÿ

ç±»ä¼¼äºè¿™æ ·çš„é—®é¢˜çš„è§£æ³•ç§°ä¸º**ä¸­å›½å‰©ä½™å®šç†**

**è§£æ³•**

+ æ‰¾å‡ºä¸‰ä¸ªæ•°ï¼šä» 3 å’Œ5 çš„å€æ•°æ‰¾å‡ºé™¤

**æ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼ˆEXCRTï¼‰** ï¼š





#### é«˜æ¬¡åŒä½™æ–¹ç¨‹



### åšå¼ˆè®º

**å¥‡å¼‚å±€åŠ¿**:ä¼šé€ æˆåæ‰‹å¿…èƒœçš„å±€åŠ¿ã€‚

**çº³ä»€å‡è¡¡**ï¼šæˆ‘ä»¬åªèƒ½é€‰æ‹©å¯¹è‡ªå·±æœ€å¥½çš„å±€é¢ï¼Œå› ä¸ºæ— æ³•çŸ¥é“åˆ«äººä¼šæ€ä¹ˆèµ°ã€‚ï¼ˆè‡ªç§åœ°æŠŠå‘½è¿æŒæ¡åœ¨è‡ªå·±æ‰‹é‡Œï¼‰

#### Bash åšå¼ˆ

1å †çŸ³å­æœ‰nä¸ªï¼Œæ¯æ¬¡æœ€å¤šå–`m`ä¸ªï¼Œæœ€å°‘1ä¸ª

**å¥‡å¼‚å±€åŠ¿**ï¼š`(m+1)`

+ `n = m + 1`,é‚£ä¹ˆåè€…å¿…èƒœ
+ `n = (m+1) * r + s`ï¼Œå…ˆæ‰‹å–**s**ä¸ªï¼Œå¿…èƒœã€‚
+ `n = r * ( m + 1 )`ï¼Œå…ˆæ‰‹å¿…è´¥

#### Nimm åšå¼ˆ

æœ‰nå †çŸ³å­ï¼Œæ¯å †çŸ³å­æ•°é‡ä¸º$a_1,a_2,a_3...$ ,è½®æµæŒ‘ä¸€å †å–è‡³å°‘ä¸€ä¸ªçŸ³å­ï¼Œå–å®Œè€…è·èƒœ

**å¥‡å¼‚å±€åŠ¿** ï¼š`(m,m)`

+ `n = 1 `ï¼Œå…ˆæ‰‹å…¨æ‹¿ï¼Œå…ˆæ‰‹å¿…èƒœ
+ `n = 2`
  + `(m,m)`ï¼šå…ˆæ‰‹å¿…è¾“ï¼Œåæ‰‹åªéœ€ä¸å…ˆæ‰‹è¿›è¡Œç›¸åŒçš„æ“ä½œ
  + `(m,M)`ï¼šå…ˆæ‰‹ä»ä¸€å †ä¸­å–`(M-m)` ä¸ªï¼Œæ­¤æ—¶åæ‰‹é¢å¯¹`(m,m)`å±€é¢ï¼Œå¿…è¾“
+ `n = 3`
  + `(m,m,M)` å…ˆæ‰‹å¿…èƒœï¼Œåªéœ€å–èµ°Mä¸ªï¼Œå‰©ä¸‹`(m,m)`
  + `(a1,a2,a3)`ï¼šå¼‚æˆ–ç»“æœä¸º0åˆ™å…ˆæ‰‹å¿…è¾“ï¼Œå¦åˆ™å¿…èƒœ



#### Wythoff åšå¼ˆ

æœ‰ä¸¤å †è‹¥å¹²ä¸ªç‰©å“ï¼Œä¸¤äººè½®æµä»ä»»ä¸€å †å–è‡³å°‘ä¸€ä¸ªæˆ–åŒæ—¶ä»ä¸¤å †ä¸­å–èµ°ç›¸åŒå¤šçš„ç‰©å“ï¼Œæ¯æ¬¡è‡³å°‘å–ä¸€ä¸ªï¼Œå–å®Œèƒœåˆ©ã€‚

**å¥‡å¼‚å±€åŠ¿**ï¼š`(1,2)` 

```tex
//è§„å¾‹
0,0
1,2
3,5
4,7
6,10
8,13
9,15
11,18
```

å·®å€¼æ˜¯é€’å¢çš„ï¼Œ0,1,2,...n

```cpp
//éšè—è§„å¾‹
a = floor((b-a)*1,618)
```





### æ¦‚ç‡ä¸æœŸæœ›

**æœŸæœ›**ï¼šè®¾ä¸€ä¸ªç¦»æ•£å‹éšæœºå˜é‡ x*x* æ‰€æœ‰å¯èƒ½çš„å–å€¼åˆ†åˆ«ä¸º $x_1,x_2,x_3,...,x_n$ï¼Œè¿™äº›å€¼çš„å¯¹åº”æ¦‚ç‡æ˜¯ $p_1,p_2,p_3,...,p_n$ï¼Œåˆ™$E(x)=x_1p_1+x_2p_2+...+x_np_n$ å«åšè¿™ä¸ª**ç¦»æ•£å‹éšæœºå˜é‡ xçš„å‡å€¼**æˆ–**æ•°å­¦æœŸæœ›**ï¼ˆç®€ç§°**æœŸæœ›**ï¼‰







### ç»„åˆæ•°å­¦

#### Lucas



#### å¡ç‰¹å…°æ•°



#### æ–¯ç‰¹æ—æ•°







#### å®¹æ–¥åŸç†

[åšå®¢](https://blog.csdn.net/AGNING/article/details/105371507?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166062540216780357250140%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166062540216780357250140&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105371507-null-null.142^v40^pc_rank_34_2,185^v2^control&utm_term=å®¹æ–¥åŸç†&spm=1018.2226.3001.4187)

**æ¦‚å¿µ**

[![vsYttx.png](https://s1.ax1x.com/2022/08/20/vsYttx.png)](https://imgse.com/i/vsYttx)

è¦æŠŠ1-nä¸­2ã€3ã€5çš„å€æ•°å…¨éƒ¨ç­›æ‰ï¼Œé‚£ä¹ˆå…ˆç­›2çš„å€æ•°ï¼Œå†ç­›3çš„å€æ•°ï¼Œå†ç­›5çš„å€æ•°ï¼Œè¿™æ ·çš„è¯6ã€10ã€15çš„å€æ•°å°±è¢«ç­›äº†ä¸¤éï¼Œ30çš„å€æ•°å°±è¢«ç­›äº†ä¸‰éã€‚å› æ­¤ï¼Œåªè¦å‡å»6ã€10ã€15çš„å€æ•°ï¼Œä½†æ˜¯è¿™æ ·ä¸€å‡ï¼Œ30çš„å€æ•°åˆè¢«å‡äº†3éï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ30çš„å€æ•°æ²¡æœ‰è¢«åŠ è¿‡ï¼Œæ‰€ä»¥å†åŠ ä¸Šå°±å¯ä»¥äº†ã€‚

å®¹æ–¥åŸç†å¯ä»¥ç”¨æ¥æ±‚1-nä¸­çš„æ‰€æœ‰è´¨æ•°ã€‚

**å®ç°**

å…ˆåˆ†è§£è´¨å› å­ï¼š

```cpp
 for (int i = 2; i * i <= k; i++) {
        if (k % i == 0) {
            p[++tail] = i;  //på°±æ˜¯å‚¨å­˜è´¨å› å­çš„æ•°ç»„
            while (k % i == 0) k /= i;  //æŠŠkä¸­æ‰€æœ‰içš„è´¨å› å­å…¨éƒ¨é™¤å»
        }
    }
    if (k > 1) p[++tail] = k;  //æœ€åå¦‚æœå¤§äºä¸€ï¼Œåˆ™æœ€åä¸€ä¸ªæ•°ä¸€å®šæ˜¯è´¨å› å­ï¼Œè¿™ä¸€æ­¥å¯èƒ½æœ‰ä¸€ç‚¹éš¾ç†è§£ï¼Œå¯ä»¥å¤šæƒ³æƒ³
```

å†å®ç°å®¹æ–¥ï¼š

```cpp
long long fun(long long x){
    long long res=0;  //è®°å½•1-xä¸­ä¸kä¸äº’è´¨çš„æ•°é‡
    for(int i=1;i<(1<<tail);i++){  //è¿™é‡Œçš„1<<tailæ˜¯æŒ‡2çš„tailæ¬¡æ–¹ï¼Œè¡¨ç¤ºtailä¸ªè´¨å› å­æœ‰å¤šå°‘ç§ç»„åˆæƒ…å†µ 
        long long cur=1,cnt=0;  //curè¡¨ç¤ºåœ¨å½“å‰é€‰ä¸­çš„è´¨å› å­ä¸­çš„ä¹˜ç§¯ï¼Œcntè¡¨ç¤ºå½“å‰é€‰ä¸­çš„æ•°é‡æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•° 
        for(int j=0;j<tail;j++){  //è¿™ä¸ªå¾ªç¯æ˜¯æšä¸¾tailçš„äºŒè¿›åˆ¶å½¢å¼ 
            if((i>>j)&1){  //è¿™ä¸ªæ˜¯åˆ¤æ–­içš„ç¬¬jä½æ˜¯ä¸æ˜¯1ï¼Œå¦‚æœæ˜¯åˆ™è¡¨ç¤ºé€‰ä¸­ç¬¬jä¸ªæ•° 
                cnt++;  //è¡¨ç¤ºé€‰ä¸­äº†å‡ ä¸ªæ•°ï¼Œæ¯é€‰ä¸­ä¸€ä¸ªå°±åŠ ä¸€ 
                cur*=p[j+1];  //é€‰ä¸­ç¬¬jä¸ªæ•°å°±ç”¨curä¹˜ä»¥ç¬¬jä¸ªè´¨å› å­æ•°ï¼Œæ³¨æ„è´¨å› å­æ•°ç»„æ˜¯ä»1å¼€å§‹çš„ï¼Œæ‰€ä»¥è¦åŠ ä¸€ 
            }
        }
        if(cnt&1) res+=x/cur;  //å¦‚æœcntæ˜¯å¶æ•°å°±ç›¸åŠ  
        else res-=x/cur;  //å¥‡æ•°å°±ç›¸å‡ 
    }
    return x-res;  //reså‚¨å­˜çš„æ˜¯1-xä¸­ä¸Kä¸äº’è´¨çš„æ•°é‡ï¼Œæ‰€ä»¥è¦ç”¨x-reså¾—åˆ°äº’è´¨çš„æ•°é‡ 
}


```



### çº¿æ€§ä»£æ•°

#### é«˜æ–¯æ¶ˆå…ƒæ³•





#### çº¿æ€§åŸº

**å®šä¹‰**

çº¿æ€§åŸºæ˜¯ä¸€ä¸ª**æ•°çš„é›†åˆ**ï¼Œæ¯ä¸ªåºåˆ—è‡³å°‘æœ‰ä¸€ä¸ªçº¿æ€§åŸºï¼Œä»çº¿æ€§åŸºä¸­å–è‹¥å¹²ä¸ªæ•°å¼‚æˆ–å¯ä»¥å¾—åˆ°åŸåºåˆ—ä¸­çš„ä»»ä½•ä¸€ä¸ªæ•°ã€‚

**æ€§è´¨**

+ åŸåºåˆ—é‡Œé¢çš„ä»»æ„ä¸€ä¸ªæ•°éƒ½å¯ä»¥ç”±çº¿æ€§åŸºé‡Œé¢çš„ä¸€äº›æ•°å¼‚æˆ–å¾—åˆ°
+ çº¿æ€§åŸºé‡Œé¢çš„ä»»æ„ä¸€äº›æ•°å¼‚æˆ–èµ·æ¥éƒ½ä¸èƒ½å¾—åˆ° 0 
+ çº¿æ€§åŸºé‡Œé¢çš„æ•°çš„ä¸ªæ•°å”¯ä¸€ï¼Œå¹¶ä¸”åœ¨ä¿æŒæ€§è´¨ä¸€çš„å‰æä¸‹ï¼Œæ•°çš„ä¸ªæ•°æ˜¯æœ€å°‘çš„

**æ±‚æ³•**

å…·ä½“æ„é€ æ–¹æ³•ï¼š

è‹¥è¦æ’å…¥ä¸€ä¸ªæ•°`x`ï¼Œè¿™ä¸ªxæœ€é«˜ä½ä¸º`d`

é‚£ä¹ˆæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ä¸ªæ˜¯`d`ä½è¿˜æœªæ’å…¥å€¼ï¼Œé‚£å°±ç›´æ¥æ’å…¥`x`

å¦ä¸€ä¸ªæ˜¯å·²ç»æœ‰å€¼äº†ï¼Œé‚£å°±æŠŠ`x`å¼‚æˆ–å½“å‰çš„å€¼ï¼ˆ`d[i]`ï¼‰ï¼Œç„¶åæ¥ä¸‹å»å¯»æ‰¾

```cpp
void add(ll x)
{
    for(int i=60;i>=0;i--)
    {
        if(x&(1ll<<i))//æ³¨æ„ï¼Œå¦‚æœiå¤§äº31ï¼Œå‰é¢çš„1çš„åé¢ä¸€å®šè¦åŠ ll
        {
            if(d[i])x^=d[i];
            else
            {
                d[i]=x;
                break;//æ’å…¥æˆåŠŸå°±é€€å‡º
            }
        }
    }
}
```



### å¤šé¡¹å¼

[åšå®¢](https://blog.csdn.net/juruo_hejiarui/article/details/108563218)

#### FFT-å¿«é€Ÿå‚…é‡Œå¶å˜æ¢



### è«æ¯”ä¹Œæ–¯åæ¼”







### æ•°å€¼æ–¹æ³•

#### ä¸‰åˆ†æ³•

å‡è®¾é¢˜æ„æ±‚å•å³°å‡½æ•°çš„æœ€å€¼ç‚¹ï¼Œé‚£ä¹ˆæ¯æ¬¡å–ä¸¤ä¸ªç‚¹ï¼š`x = (2*l+r)/3` , `y = l+(2*r)/3` 

è‹¥åªæœ‰æœ€å¤§å€¼ï¼Œåˆ™ åˆ†ä¸ºä¸¤ç§æƒ…å†µ

+ `f(x)>f(y)` ï¼Œèˆå¼ƒ$[y,r]$

+ `f(x)<f(y)`ï¼Œèˆå¼ƒ$[l,x]$

![image.png](https://s2.loli.net/2022/08/15/vOA3olE6s7IFRak.png)

```cpp
while (abs(r - l) > exp) {
        double x = (2 * l + r) / 3, y = (l + 2 * r) / 3;
        if (f(x) < f(y)) {
            l = x;
        } else {
            r = y;
        }
    }
```



#### è‡ªé€‚åº”è¾›æ™®æ£®æ³•





### åº·æ‰˜å±•å¼€

**å®šä¹‰** ï¼šç»™å®šè‡ªç„¶æ•°æ’åˆ—ï¼Œæ±‚å‡ºç”±å°åˆ°å¤§ä¸­æ‰€æœ‰æ’åˆ—çš„è¯¥æ’åˆ—åºå·

![](https://i.bmp.ovh/imgs/2022/08/19/8b20cd5cf04fcce4.png)

ä»¥ä¸‹æ˜¯O(n^2)åšæ³•ï¼Œå¯ç”¨æ ‘çŠ¶æ•°ç»„å­˜tmpï¼Œå°†æ—¶é—´å¤æ‚åº¦é™ä½åˆ°O(nlogn)


```cpp
void jiecheng(int x)
{
    f[0]= f[1] =1;
    for(int i = 2; i <= n; i++) f[i] = f[i - 1] * i;
}
int kangtuo()
{
    int ans =1;
    int len = str.length();
    
    for(int i=0;i<len;i++)
    {
        int tmp =0;
        for(int j=i+1;j<len;j++)
        {
            if(str[i]>str[j]) tmp++;
        }
        ans+=tmp*f[len-i+1];
    }
    return ans;
}
```



#### é€†å±•å¼€

**å®šä¹‰** ï¼šç»™å®šä¸€ä¸ªåºå·ï¼Œæ±‚å‡ºå¯¹åº”çš„è‡ªç„¶æ•°æ’åˆ—

```cpp
void jie_cheng(int n)
{
    f[0] = f[1] = 1; // 0çš„é˜¶ä¹˜ä¸º1
    for(int i = 2; i <= n; i++) f[i] = f[i - 1] * i;
}

vector<char> vec; //å­˜éœ€è¦æ’åˆ—çš„å­—ç¬¦
void rev_kangtuo(int k) //è¾“å‡ºåºå·ä¸º k çš„å­—ç¬¦åºåˆ—
{
    int n = vec.size(), len = 0;
    string ans = "";
    k--; // ç®—çš„æ—¶å€™æ˜¯æŒ‰ 12345 æ˜¯ç¬¬0ä½
    for(int i = 1; i <= n; i++){
        int t = k / f[n - i]; // ç¬¬ i ä½éœ€è¦ ç¬¬ t + 1 å¤§çš„æ•°
        k %= f[n - i];        //å‰©ä¸‹çš„å‡ ä½éœ€è¦æä¾›çš„æ’åˆ—æ•°
        ans += vec[t] ; //  vec[t] å°±æ˜¯ç¬¬ t + 1 å¤§çš„æ•°
        vec.erase(vec.begin() + t); 
//ç”¨è¿‡å°±åˆ äº†ï¼Œä¸ç”¨vectorç”¨æš´åŠ›ä¹Ÿå¯ä»¥ï¼Œå°±æ˜¯è¯´æšä¸¾ï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªçš„æ¯”è¾ƒå¤§å°ï¼Œå¹¶è®°å½•æœ‰å‡ ä¸ªæ²¡ç”¨è¿‡çš„å­—ç¬¦ä¸”å­—å…¸åºæ¯”å®ƒå°
    }
    cout << ans << '\n';
}
```





### æ¬§æ‹‰å®šç†

**å®šä¹‰** ï¼šå¯¹ä»»æ„ä¸¤ä¸ªæ­£æ•´æ•°a,nï¼Œè‹¥ä¸¤è€…äº’è´¨ï¼Œåˆ™$a^{Ï†(n)}â‰¡1(mod n)$

â€‹	å¯ç”¨äºé™å¹‚æ“ä½œã€‚

#### å‰ç½®çŸ¥è¯†

æ¬§æ‹‰å‡½æ•°

#### æ‰©å±•æ¬§æ‹‰å®šç†

![](https://i.bmp.ovh/imgs/2022/08/19/dee20be7eed215b7.png)

##### åº”ç”¨èŒƒå›´

æ‰©å±•æ¬§æ‹‰å®šç†é€‚ç”¨äºæ¨¡æ•°è¾ƒå°ï¼ŒæŒ‡æ•°è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œé™å¹‚æ“ä½œã€‚

+ é…åˆå¤§æ•°å–ä½™æ±‚è§£

e.g. ç»™å®š a,m,bï¼Œ æ±‚ $a^b mod\ m$ 



### æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†

#### åº”ç”¨

##### äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹





## è®¡ç®—å‡ ä½•

### å‡¸åŒ…

ä»€ä¹ˆæ˜¯**å‡¸åŒ…**ï¼Ÿ

[![vHEPTe.png](https://s1.ax1x.com/2022/09/06/vHEPTe.png)](https://imgse.com/i/vHEPTe)



**å…³é”®çŸ¥è¯†**ï¼š

+ æè§’æ’åºï¼šé€‰å–ä¸€ä¸ªæœ€å·¦çš„ç‚¹ï¼ŒæŒ‰yæœ€å°ï¼Œå…¶æ¬¡xæœ€å°æ¥å®šä¹‰ï¼Œæ¥ä¸‹æ¥æ‰€æœ‰çš„ç‚¹é’ˆå¯¹è¯¥ç‚¹çš„å°„çº¿ï¼ŒæŒ‰è§’åº¦ç”±å°åˆ°å¤§ï¼Œè‹¥ç›¸åŒæŒ‰è·ç¦»ç”±è¿‘åˆ°è¿œæ¥æ’åºã€‚
+ å·¦è½¬åˆ¤å®šï¼šåˆ©ç”¨å‰ç§¯ã€‚å¯¹äºå‘é‡p1(x1,y1),p2(x2,y2)å¦‚æœx1*y2-x2*y1>0,åˆ™ä»p1åˆ°p2å·¦è½¬ã€‚

**æ±‚è§£æ–¹æ³•** ---  `Grahamæ‰«ææ³•`

ä¸€ã€åœ¨è¾“å…¥è¿‡ç¨‹ä¸­æ‰¾åˆ°æœ€å·¦ä¸‹çš„ç‚¹`a`

äºŒã€å°†å…¶ä»–æ‰€æœ‰çš„ç‚¹å¯¹aç‚¹è¿›è¡Œ**æè§’æ’åº**

ä¸‰ã€ä¾æ¬¡è¿›è¡Œåˆ¤å®šï¼Œå¦‚æœæ»¡è¶³å·¦è½¬ï¼Œé‚£ä¹ˆå°±åŠ å…¥ï¼Œå¦åˆ™å¦‚æœå³è½¬æˆ–è€…åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šï¼Œé‚£ä¹ˆå°±æŠŠä¹‹å‰çš„ç‚¹é€€å‡ºï¼Œç›´åˆ°æ»¡è¶³æ¡ä»¶

```cpp
struct Point
{
    double x;
    double y;
} a[maxn], s[maxn];
double d(Point p1,Point p2)//ä¸¤ç‚¹é—´è·ç¦»ã€‚ã€‚ã€‚ 
{
    return sqrt((p2.y-p1.y)*(p2.y-p1.y)+(p2.x-p1.x)*(p2.x-p1.x));
}
double check(Point a1, Point a2, Point b1, Point b2)
{
    return (a2.x - a1.x) * (b2.y - b1.y) - (b2.x - b1.x) * (a2.y - a1.y);
} // å¤§äº0åˆ™ båœ¨ a çš„ä¸Šæ–¹ï¼Œ å°äº0 å°±æ˜¯ b åœ¨ a çš„ä¸‹æ–¹
bool cmp(Point p, Point q)  //æè§’æ’åº
{
    double tmp = check(a[1], p, a[1], q);
    if (tmp > 0)
        return 1;
    if (tmp == 0 && d(a[0], p) < d(a[0], q))
        return 1;
    return 0;
}
int main()
{
    cin >> n;
    cin >> a[1].x >> a[1].y;
    for (int i = 2; i <= n; i++)
    {
        cin >> a[i].x >> a[i].y;
        if (a[i].y < a[1].y)
            swap(a[i], a[1]);
        else if (a[i].y==a[1].y && a[i].x<a[1].x)
            swap(a[1], a[i]);
    }
    sort(a + 2, a + n + 1, cmp);
    s[++top] = a[1];
    double ans = 0;
    for (int i = 2; i <= n; i++)
    {
        while (top > 1 && check(s[top - 1], s[top], s[top], a[i]) <= 0)
            top--;
        s[++top] = a[i];
    }
    s[top + 1] = a[1];
    for (int i = 1; i <= top; i++)
    {
        ans += d(s[i], s[i + 1]);
    }
    printf("%.2lf", ans);
}
```





### æ—‹è½¬å¡å£³

**åº”ç”¨**ï¼š

+ è®¡ç®—è·ç¦»
  - å‡¸å¤šè¾¹å½¢ç›´å¾„
  - å‡¸å¤šè¾¹å½¢å®½
  - å‡¸å¤šè¾¹å½¢é—´æœ€å¤§è·ç¦»
  - å‡¸å¤šè¾¹å½¢é—´æœ€å°è·ç¦»
+ å¤–æ¥çŸ©å½¢
  - æœ€å°é¢ç§¯å¤–æ¥çŸ©å½¢
  - æœ€å°å‘¨é•¿å¤–æ¥çŸ©å½¢



#### å‡¸åŒ…ç›´å¾„

[![vHZ8s0.png](https://s1.ax1x.com/2022/09/06/vHZ8s0.png)](https://imgse.com/i/vHZ8s0)



å…ˆæ±‚å‡ºæœ€ä¸Šé¢å’Œæœ€ä¸‹é¢çš„ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œåˆ†åˆ«åœ¨ä¸¤ä¸ªç‚¹ä½œæ°´å¹³çº¿ï¼Œå†ä¸æ–­æ—‹è½¬ï¼Œåˆ†åˆ«ç®—å‡ºé‡åˆ°çš„å¯¹è¸µç‚¹çš„è·ç¦»ï¼Œæ±‚å‡ºæœ€å¤§å€¼å³å¯ã€‚

```cpp
//é¢„å…ˆåšä¸€æ¬¡å‡¸åŒ…æ“ä½œï¼Œå½¢æˆä¸€ä¸ªå‡¸åŒ…ï¼Œç„¶åsol

int sol()
{
    if (top == 1)
        return 0;
    if (top == 2)
        return d(s[1], s[2]);
    int v = 2;
    int ans = 0;
    for (int i = 1; i <= top; ++i)
    {
        while (check(s[i], s[i + 1], s[i + 1], s[v]) <= check(s[i], s[i + 1], s[i + 1], s[v + 1]))
            v = v == top ? 1 : v + 1;
        ans = max(ans, max(d(s[i], s[v]), d(s[i + 1], s[v])));
    }

    return ans;
}
```





### åŠå¹³é¢äº¤
