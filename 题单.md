## é¢˜å•

+ [åŸºç¡€ç®—æ³•](https://www.luogu.com.cn/training/2929)
+ [æ‹“å±•æ¨¡æ¿](https://www.luogu.com.cn/training/2650)  éš¾åº¦è¾ƒå¤§
+ [æé«˜æ•°æ®ç»“æ„](https://www.luogu.com.cn/training/2649)
+ [è¿›é˜¶æ•°æ®ç»“æ„](https://www.luogu.com.cn/training/3367#information)
+ [DPåŸºç¡€](https://www.luogu.com.cn/training/5011)
+ [åŠ¨æ€è§„åˆ’æé«˜](https://www.luogu.com.cn/training/12927)
+ [åŠ¨æ€è§„åˆ’ç»¼åˆ](https://www.luogu.com.cn/training/1435#information)
+ [æ•°è®º](https://www.luogu.com.cn/training/3135#information)
+ [å›¾è®ºæ¨¡æ¿](https://www.luogu.com.cn/training/3364)
+ [æé«˜å›¾è®º](https://www.luogu.com.cn/training/4969)
+ [æ€ç»´é¢˜](https://www.luogu.com.cn/training/4865#problems)
+ [ç»¼åˆ](https://www.luogu.com.cn/training/9391)



## åŸºç¡€ç®—æ³•

### ç´ æ•°ç­›æ³•

#### çº¿æ€§ç­›ï¼ˆæœ€å¿«ï¼‰

æ—¶é—´å¤æ‚åº¦ï¼šO(n)

```cpp
int Mark[MAXSIZE];  
int prime[MAXSIZE];  

//åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªç´ æ•°  Mark æ ‡è®°æ•°ç»„ index ç´ æ•°ä¸ªæ•°  
int Prime(){  
    int index = 0;  
    for(int i = 2; i < MAXSIZE; i++){  
        //å¦‚æœæœªæ ‡è®°åˆ™å¾—åˆ°ä¸€ä¸ªç´ æ•°  
        if(Mark[i] == 0) prime[++index] = i;  
        //æ ‡è®°ç›®å‰å¾—åˆ°çš„ç´ æ•°çš„iå€ä¸ºéç´ æ•°  
        for(int j = 1; j <= index && prime[j] * i < MAXSIZE; j++){  
            Mark[i * prime[j]] = 1;  
            if(i % prime[j] == 0) break;  
        }  
    }  
    return index;  
}
```



#### æ¬§æ‹‰ç­›

**æ—¶é—´å¤æ‚åº¦ï¼šO(n)**

**åŸç†**ï¼šå¦‚æœåˆ¤æ–­24æ˜¯å¦ä¸ºä¸€ä¸ªç´ æ•°é‚£ä¹ˆç”¨åŸƒæ°ç­›çš„è¯èµ·ç ä¼šé‡å¤ç­›24ä¸‰æ¬¡ï¼ˆ2\*12ï¼Œ3\*8ï¼Œ4\*6ï¼‰ï¼Œé‚£æ¬§æ‹‰ç­›å°±æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šåªç­›ä¸€æ¬¡å°±æ˜¯å…¶æœ€å°è´¨å› æ•°ä¸å› ä¸€ä¸ªåˆæ•°çš„ä¹˜ç§¯ã€‚

```cpp
#include <bits/stdc++.h>//æ¬§æ‹‰ç­›

using namespace std;
bool A[100000001];
int prime[1000001];

int main() {
    int n, m;
    scanf("%d %d", &n, &m);
    int cnt = 0;
    for (int i = 2; i <= n; i++) {
        if (A[i] == false) {
            prime[++cnt] = i;
        }
        for (int j = 1; j <= cnt && i * prime[j] <= n; j++) {
            A[i * prime[j]] = true;
            if (i % prime[j] == 0) break;//æœ€é‡è¦çš„ä¸€æ­¥
        }
    }
    for (int i = 0; i < m; i++) {
        int c;
        scanf("%d", &c);
        printf("%d\n", prime[c]);
    }
    return 0;
}
```



### å¿«é€Ÿå¹‚

æœ€å¿«çš„å¿«é€Ÿå¹‚ç®—æ³•ï¼Œè¿ç”¨äº†ä½è¿ç®—å¤§å¤§åŠ å¿«è¿ç®—é€Ÿåº¦ã€‚

```cpp
long long fastPower(long long base, long long power) {
    long long result = 1;
    while (power > 0) {
        if (power & 1) {//æ­¤å¤„ç­‰ä»·äºif(power%2==1)
            result = result * base ;
        }
        power >>= 1;//æ­¤å¤„ç­‰ä»·äºpower=power/2
        base = (base * base) ;
    }
    return result;
}
```



### çŸ©é˜µå¿«é€Ÿå¹‚

**å…ˆä¿®çŸ¥è¯†ï¼šçº¿æ€§ä»£æ•°  ï¼ˆç‹—å¤´ï¼‰**

æ—¶é—´å¤æ‚åº¦ï¼š$O(log_2k)$ 

```cpp
struct matrix
{
    int n,m;   
    int e[105][105];
}
matrix a,b;

matrix mul(matrix a,matrix b)
{
    matrix ans;
    ans.n=a.n;
    ans.m=b.m;
    
    for(int i=1;i<=ans.m;i++)
   		for(int j=1;j<=ans.m;j++)
            ans.e[i][j]=0;     //åˆå§‹åŒ–
    
    for(int i=1;i<=a.n;i++)
        for(int j=1;j<=b.m;j++)
            for(int k=1;k<=a.m;k++)
                ans.e[i][j]=(ans.e[i][j]+(a.e[i][k]*b.e[k][j])%mod)%mod;//å¿«é€Ÿå¹‚çš„å–æ¨¡å°±åœ¨è¿™é‡Œäº†ï¼
    return ans;
}

matrix power(matrix a,ll b)
{
    matrix ans;
    ans.n=a.n;
    ans.m=a.m;
    //åˆå§‹åŒ–ä¸ºå•å…ƒçŸ©é˜µ
    for(int i=1;i<=ans.n;i++)
    	for(int j=1;j<=ans.m;j++)
            if(i==j) 
                ans.e[i][j]=1;
    		else 
                ans.e[i][j]=0;    
    
    while(b)
    {
        if(b&1)
            ans=mul(ans,a);
       	a=mul(a,a);
        b>>=1;
    }
    return ans;
}
```



### ä¸‰åˆ†æ³•

å‡è®¾é¢˜æ„æ±‚å•å³°å‡½æ•°çš„æœ€å€¼ç‚¹ï¼Œé‚£ä¹ˆæ¯æ¬¡å–ä¸¤ä¸ªç‚¹ï¼š`x = (2*l+r)/3` , `y = l+(2*r)/3` 

è‹¥åªæœ‰æœ€å¤§å€¼ï¼Œåˆ™ åˆ†ä¸ºä¸¤ç§æƒ…å†µ

+ `f(x)>f(y)` ï¼Œèˆå¼ƒ$[y,r]$

+ `f(x)<f(y)`ï¼Œèˆå¼ƒ$[l,x]$

![image.png](https://s2.loli.net/2022/08/15/vOA3olE6s7IFRak.png)

```cpp
while (abs(r - l) > exp) {
        double x = (2 * l + r) / 3, y = (l + 2 * r) / 3;
        if (f(x) < f(y)) {
            l = x;
        } else {
            r = y;
        }
    }
```





### å­—ç¬¦ä¸²ç®—æ³•

#### KMP

ç”¨äºåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

+ ç”¨ä¸€ä¸ªnexæ•°ç»„ç»´æŠ¤ æœ€é•¿çš„ å‰ç¼€ä¸åç¼€ç›¸åŒçš„å­ä¸²ï¼ˆæœ€å¤§ä¸º n-1 ï¼‰



#### Manacher



#### Sam



#### Pam



### STç®—æ³•

**RMQ**ï¼šåŒºé—´æœ€å¤§å€¼/æœ€å°å€¼æŸ¥è¯¢

#### å¤æ‚åº¦

é¢„å¤„ç†ï¼š`O(nlogn)`

æŸ¥è¯¢ï¼š`O(1)`



#### å®ç°

é¢„å¤„ç†ï¼Œç®—å‡ºæ¯ä¸ªåŒºé—´ä¹‹é—´çš„æœ€å€¼ã€‚

```cpp
void init(int x)
{
  	for(int i=1;i<=n;i++)
        st[i][0]=a[i];
  	
  	for(int j=1;(1<<j)=sizeof(a);j++)
    {
      	for(int i=1;i+(1<<(j-1))<=sizeof(a);i++)
        {
          	st[i][j] = max(st[i][j-1],st[i+(1<<(j-1))][j-1]);
        }
    }
}
```



æŸ¥è¯¢

```cpp
int Log[n+7];
void getLog()
{
	Log[1] = 0;
	for(int i=2;i<=n+1;i++)
		Log[i] = Log[i/2]+1;
}

int query(int l,int r)
{
   int k = Log(r-l+1);
   ans = max(st[l][k],st[r-(1<<k)+1][k];
   return ans;
}
```



## æ•°æ®ç»“æ„

### é“¾è¡¨

**å­˜å‚¨çº¿æ€§è¡¨çš„æ•°æ®å…ƒç´ ï¼Œå¯ä»¥æ˜¯ä¸è¿ç»­çš„**

##### åŠ¨æ€é“¾è¡¨

```c++
#åˆå§‹åŒ–
struct node{
    int data;
    node *next;
};

node *head, *p, *now, *prev;

head = new node;          //å®šä¹‰å˜é‡
head->data = 1;          //åˆ†é…ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•°æ®ç½®ä¸º1
head->next = NULL;  //
now = head;  //å½“å‰æŒ‡é’ˆä¸ºå¤´æŒ‡é’ˆ
```



##### ç»“æ„ä½“å®ç°é“¾è¡¨

```c++
(å•å‘)
struct node{
    int id;
    int nextid;
}nodes[maxn];

nodes[0].nextid = 1;
for(int i=1;i<=n;i++)
{
    nodes[i].id=i;
    nodes[i].nextid = i+1;
}
nodes[n].nextid = 1;  //å¾ªç¯é“¾è¡¨

```



##### STL list

listä¸ºåŒå‘é“¾è¡¨ã€‚

```c++
åˆå§‹åŒ–
list<int> l1;  //ç©ºå¯¹è±¡
list<int> l2(3,1); //åŒ…å«3ä¸ª1çš„å¯¹è±¡

éå†

list<int>::iterator it = l2.begin();
while(it != l2.end())
{
    *it += 1;
    cout<<*it<<' ';
    it++;
}

èŒƒå›´foréå†
for(auto& e:l2)
{
    cout<<e<<' ';
}

æ’å…¥
l1.push_back(xx);
l1.push_front(xx);
l1.pop_front();
l1.pop_back();

insert:
auto pos = ++l1.begin();
l1.insert(pos,5); //åœ¨posä½ç½®å‰åŠ ä¸€ä¸ª5
l1.insert(pos,3,5); //åœ¨posä½ç½®å‰åŠ 3ä¸ª5

erase:
l1.erase(pos);   //åˆ é™¤posä½ç½®å…ƒç´ 
l1.erase(++le.begin(),--l1.end());  //åˆ é™¤ä¸­é—´å†…å®¹


æ¸…ç©ºï¼š
l1.clear();

```





### å¹¶æŸ¥é›†

**ä¸€ç§æ ‘å½¢æ•°æ®ç»“æ„ï¼Œç”¨äºå¤„ç†ä¸äº¤é›†çš„åˆå¹¶åŠæŸ¥è¯¢é—®é¢˜**

#### åˆ›å»º

```c
void init(int size){
    for(int i=0;i<size;i++)
    {
        fa[i]=i;
    }
}
```



#### æŸ¥æ‰¾

```c
int find(int x){
    if(fa[x]==x)
        return x;
    else
        return find(fa[x]);
}

//è·¯å¾„å‹ç¼©ç‰ˆæœ¬

int find(int x){
    if(fa[x]!=x)
        fa[x]=find(fa[x]);
    return fa[x];
}
```



#### åˆå¹¶

```c
viod merge(int x,int y){
    x=find(x);
    y=find(y);
    fa[x]=y;
}
```



#### å¯å‘å¼åˆå¹¶ï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰

è¿ç”¨äºï¼š å¯æŒä¹…åŒ–å¹¶æŸ¥é›†ã€çº¿æ®µæ ‘åˆ†æ²» + å¹¶æŸ¥é›†

```c
//é€‰æ‹©ç‚¹æ•°ä½œä¸ºä¼°ä»·å‡½æ•°

vector<int> size(N,1);  //è®°å½•å¹¶åˆå§‹åŒ–å­æ ‘çš„å¤§å°ä¸º1

void merge(int x,int y){
    int xx = find(x);
    int yy = find(y);
    if(xx == yy) return;
    if(siez[xx] > size[yy])  // ä¿è¯å°çš„åˆå¹¶åˆ°å¤§çš„
        swap(xx,yy);
    fa[xx]=yy;
    size[yy]+=size[xx];
}
```





### æ ‘çŠ¶æ•°ç»„

#### åœºæ™¯

å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢ã€‚



#### å¤æ‚åº¦

æ—¶é—´å¤æ‚åº¦ï¼š æŸ¥è¯¢ä¸ä¿®æ”¹å‡ä¸º $log(n)$



**æ ¹æœ¬**ï¼š

```cpp
int lowbit(int x)   //ä½œç”¨ï¼šæ‰¾åˆ°æœ€åä¸€ä½
{
    return x&(-x);
}
```



**æ±‚å‰ç¼€å’Œ** 

```cpp
int getSum(int m){
	int ans = 0;
    while(m > 0){
        ans += C[m];
        m -= lowbit(m);
    }
    return ans;
}
```



**æ›´æ–°**

```cpp
void update(int x, int value){
    A[x] += value;	// ä¿®æ”¹æºæ•°ç»„
    while(x <= n){
        C[x] += value;
        x += lowbit(x);
    }
}

```



**ç¤ºæ„å›¾**ï¼š

![image.png](https://s2.loli.net/2022/07/22/9QK5rJvCuyUDms7.png)













### çº¿æ®µæ ‘

#### åœºæ™¯

+ å•ç‚¹ä¿®æ”¹ã€åŒºé—´ä¿®æ”¹
+ æŸ¥è¯¢åŒºé—´çš„å€¼



#### æ“ä½œ

```cpp
int t[MAXN<<2];
```



##### å»ºæ ‘

```cpp
void build(int k,int l,int r)
{
    if(l==r)
        t[k] = a[i];
   	else
    {
        int m = (r-l)<<1+l;
        build(k<<1,l,m);
        build(k<<|1,m+1,r);
    }
}
```

##### ç‚¹æ›´æ–°

```cpp
void update(int p,int v,int k,int l,int r) //ç‚¹æ›´æ–°
{
    if(l==r)
    {
        a[k] += v;
        t[k] += v;
    }
    else{
        int m = (r - l) / 2 + l;
        if (p <= m)
        {
            update(p, v, k << 1, l, m);
        }
        else{
            update(p, v, k << 1 | 1, m + 1, r);
        }
        Pushup(k);
    }
}
```

##### åŒºé—´æ›´æ–°

```cpp
void Update(int L,int R,int v,int k,int l,int r) //åŒºé—´æ›´æ–°
{
    if(L<=l && R>=r)
    {
        t[k]+=v;
        lazy[k] += v;
    }
    else
    {
        Pushdown(k);
        int m = (r - l) / 2 + l;
        if(L<=m)
        {
            Update(L, R, v, k >> 1, l, m);
        }
        if(R>m)
        {
            Update(L, R, v, k >> 1 | 1, m + 1, r);
        }
        Pushup(k);
    }
}
```

##### åŒºé—´æ±‚æœ€å€¼

```cpp

ll ask(int L,int R,int k,int l,int r)   //åŒºé—´æŸ¥è¯¢æœ€å€¼
{
    if(L<=l && R>=r)
        return t[k];
    else
    {
        Pushdown(k);
        ll ans = INF;
        int m = (r - l) / 2 + l;
        if(L<=m)
            ans = max(ans, ask(L, R, k << 1, l, m));
        if(R>=m+1)
            ans = max(ans, ask(L, R, k >> 1 | 1, m + 1, r));

        return ans;
    }
}

```



##### ä¸Šå‡

```cpp
void pushup(int k)
{
    t[k] = t[k << 1] + t[k << 1 | 1];
}
```

##### ä¸‹é™

```cpp
void pushdown(int k, int l, int r)
{
    int m = (l + r) >> 1;
    if (lazy[k] != 0)
    {
        lazy[k << 1] +=lazy[k];
        lazy[k << 1 | 1] += lazy[k];
        t[k << 1] += lazy[k] * (m - l + 1);
        t[k << 1 | 1] += lazy[k] * (r - m);
        lazy[k] = 0;
    }
}
```



### ç¬›å¡å°”æ ‘



```cpp
  for(int i=1;i<=n;i++){
        a[i]=read();
        while(a[sta[top]]>a[i]&&top) son[i][0]=sta[top--];
        if(sta[top]) son[sta[top]][1]=i;
        sta[++top]=i;
    }
    for(int i=1;i<=n;i++){
        lans=lans^(i*(son[i][0]+1));
        rans=rans^(i*(son[i][1]+1));
    }
```



## åŠ¨æ€è§„åˆ’

### æš´åŠ›DP

#### èƒŒåŒ…é—®é¢˜



#### çŠ¶å‹DP

åˆ©ç”¨äºŒè¿›åˆ¶æ•°è¡¨ç¤ºçŠ¶æ€ï¼Œé€šè¿‡æšä¸¾æ‰€æœ‰çŠ¶æ€è¿›è¡ŒåŠ¨æ€è§„åˆ’ã€‚



#### åŒºé—´DP

>  åŒºé—´dpå°±æ˜¯åœ¨åŒºé—´ä¸Šè¿›è¡Œ**åŠ¨æ€è§„åˆ’**ï¼Œæ±‚è§£ä¸€æ®µåŒºé—´ä¸Šçš„æœ€ä¼˜è§£ã€‚ä¸»è¦æ˜¯é€šè¿‡åˆå¹¶å°åŒºé—´çš„ æœ€ä¼˜è§£è¿›è€Œå¾—å‡ºæ•´ä¸ªå¤§åŒºé—´ä¸Šæœ€ä¼˜è§£çš„dpç®—æ³•ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè¦æ±‚ä¸€ä¸ªå¤§åŒºé—´ä¸­çš„æœ€ä¼˜è§£ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªå¾ˆå¤§çš„åŒºé—´ä¸æ–­åˆ†å‰²ï¼Œå˜æˆå¾ˆå°çš„ä¸€ä¸ªä¸ªåŒºé—´ï¼Œæ±‚å‡ºæ¯ä¸ªå°åŒºé—´çš„æœ€ä¼˜è§£ï¼Œç„¶ååˆå¹¶èµ·æ¥ï¼Œæœ€ç»ˆæ‰¾å‡ºå®Œæ•´åŒºé—´çš„æœ€ä¼˜è§£å³å¯ã€‚

```cpp
for(int len = 1;len<=n;len++){//æšä¸¾é•¿åº¦
        for(int j = 1;j+len<=n+1;j++){//æšä¸¾èµ·ç‚¹ï¼Œends<=n
            int ends = j+len - 1;
            for(int i = j;i<ends;i++){//æšä¸¾åˆ†å‰²ç‚¹ï¼Œæ›´æ–°å°åŒºé—´æœ€ä¼˜è§£
                dp[j][ends] = min(dp[j][ends],dp[j][i]+dp[i+1][ends]+something);
            }
        }
}
```



#### æ•°ä½DP



### æ ‘å½¢DPğŸŒŸ

[åšå®¢](https://blog.csdn.net/m0_59459037/article/details/119189656)

ä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œå‘å­èŠ‚ç‚¹åšæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¹¶ç”±å…¶å­èŠ‚ç‚¹çš„æœ€ä¼˜è§£åˆå¹¶å¾—åˆ°è¯¥èŠ‚ç‚¹çš„æœ€ä¼˜è§£ã€‚

#### æ ‘ä¸ŠåŠ¨æ€è§„åˆ’



#### æ ‘ä¸Š01èƒŒåŒ…



#### æ ‘ä¸Šå¤šé‡èƒŒåŒ…













## å›¾è®º

### å¼ºè¿é€šåˆ†é‡

[åšå®¢](https://blog.csdn.net/qq_25930891/article/details/123208901)

#### å®šä¹‰

åœ¨ä¸€ä¸ªå›¾Gä¸­ï¼Œè‹¥ä¸¤ä¸ªç‚¹äº’ç›¸å¯åˆ°è¾¾ï¼Œåˆ™ç§°è¯¥ä¸¤ç‚¹**å¼ºè¿é€š**ï¼Œè‹¥è¯¥å›¾ä¸­æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´éƒ½æ˜¯å¼ºè¿é€šï¼Œåˆ™è¯¥å›¾ä¸ºä¸€ä¸ª**å¼ºè¿é€šå›¾**ã€‚

æœ‰å‘éå¼ºè¿é€šå›¾çš„æå¤§å¼ºè¿é€šå­å›¾ï¼Œç§°ä¸º**å¼ºè¿é€šåˆ†é‡** ã€‚

#### ä½œç”¨

é™ä½å›¾çš„è§„æ¨¡ï¼Œä»è€Œå‡å°å›¾çš„å¤æ‚åº¦ã€‚

#### Tarjanç®—æ³•

å¯ä»¥æ‰¾å‡ºä¸€ä¸ªå›¾ä¸­æ‰€æœ‰çš„å¼ºè¿é€šåˆ†é‡ã€‚

ä¸æ–­dfsæœç´¢ï¼Œé‡åˆ°ç¯åˆ™è¿›è¡Œæ›´æ–°ï¼Œç„¶åè¿”å›ã€‚

```cpp
void tarjan(int x) {
    s.push(x);
    instack[x] = 1;	
    
    dfn[x] = low[x] = ++cnt; //åˆå§‹åŒ–dfnå’Œlow
    
    //æ ¸å¿ƒä»£ç ï¼Œæ·±æœè¿™ä¸ªç‚¹
    for (int i = head[x]; i; i = edge[i].next) {
        int to = edge[i].to;
        if(!dfn[to]){	//å¦‚æœä¸‹ä¸€ä¸ªç‚¹æ²¡æœ‰è¢«æœè¿‡ï¼Œ
            tarjan(to);	//ç»§ç»­æ·±æœ
            low[x] = min(low[x], low[to]); //æ›´æ–°low
        }
        else if(instack[to]){ //å¦‚æœä¸‹ä¸€ä¸ªç‚¹å·²ç»è¢«æœè¿‡ï¼Œçœ‹ä»–åœ¨ä¸åœ¨æ ˆé‡Œ
            low[x] = min(low[x], dfn[to]); //æ›´æ–°low
        }
    }
    //å¦‚æœdfn==lowï¼Œå³æ‰¾å®Œäº†ä¸€æ•´å—å¼ºè¿é€šåˆ†é‡ï¼Œå‡ºæ ˆ+æ ‡è®°
    if(dfn[x] == low[x]){
        tot++;//è®¡æ•°å™¨++ï¼Œç¬¬å‡ ä¸ªå¼ºè¿é€šåˆ†é‡
        while(s.top()!=x){ 		//ä¸åŠ 1çš„è¯xè¿™ä¸ªç‚¹ä¸ä¼šè¢«å‡ºæ ˆ
            scc[s.top()] = tot;	//æ‰“æ ‡è®°
            s.pop();//å‡ºæ ˆ
            instack[x]=0;
        }
    }
}

```



#### ç¼©ç‚¹

[åšå®¢](https://blog.csdn.net/ez_gsn/article/details/122898581?spm=1001.2101.3001.6650.7&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-122898581-blog-93732524.pc_relevant_multi_platform_featuressortv2dupreplace&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-7-122898581-blog-93732524.pc_relevant_multi_platform_featuressortv2dupreplace&utm_relevant_index=8)

å°±æ˜¯æŠŠåŸæœ¬çš„ç¯ç¼©åˆ°ä¸€ä¸ªç‚¹ä¸Šï¼Œè¿™æ ·çš„è¯å›¾ä¸­æ‰€æœ‰çš„ç¯éƒ½æ¶ˆå¤±äº†

```cpp
void search (int u)
{
	if (f[u]) return;
	f[u] = sum[u];
	int maxsum = 0;
	for (int i = hd[u]; i; i = e[i].nxt)
	{
		int v = e[i].to;
		if (!f[v]) search (v);
		maxsum = max (maxsum, f[v]);
	}
	f[u] += maxsum;
}

```



#### å‰²ç‚¹

âš ï¸ ä»…é’ˆå¯¹æ— å‘å›¾

**è¿é€š** ï¼šå›¾ä¸­ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´å¯äº’ç›¸åˆ°è¾¾

**å‰²ç‚¹**ï¼šåœ¨ä¸€ä¸ª**æ— å‘å›¾**é‡Œï¼Œå»æ‰ä¸€ä¸ªé¡¶ç‚¹ï¼ŒåŠå…¶å»æ‰è¯¥ç‚¹çš„æ‰€æœ‰è¾¹,å‰©ä¸‹çš„å›¾ä¸è¿é€šï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹å°±æ˜¯ä¸ª**å‰²ç‚¹**ã€‚

**å‰²è¾¹**ï¼šåœ¨ä¸€ä¸ª**æ— å‘å›¾**é‡Œï¼Œå»æ‰ä¸€æ¡è¾¹ï¼Œå›¾å°±ä¸è¿é€šäº†ã€‚

```cpp
#include<cstdio>
#include<cstring>
#include<algorithm>
#define _ 200010
using namespace std;
	struct node{int x,y,next;} a[_];
	int n,m,len=0,id=0,ans=0;
	int last[_],low[_],dfn[_];
/*dfn[i]è¡¨ç¤ºç‚¹iè¢«è®¿é—®çš„æ—¶é—´æˆ³ 
low[i]è¡¨ç¤ºç‚¹iåŠiçš„å­æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹èƒ½åˆ°è¾¾çš„ç»“ç‚¹ä¸­dfnæœ€å°çš„ç»“ç‚¹çš„æ—¶é—´æˆ³*/ 
	bool bz[_];
void ins(int x,int y)
{
	a[++len].x=x;a[len].y=y;a[len].next=last[x];last[x]=len;
}
void dfs(int x,int root)
//xè¡¨ç¤ºå½“å‰è®¿é—®åˆ°ç¬¬xä¸ªç‚¹,rootè¡¨ç¤ºå·²rootä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘çš„æ ¹ 
{
	int tot=0;
	low[x]=dfn[x]=++id;
//è®°å½•æ—¶é—´æˆ³ 
	for(int i=last[x];i;i=a[i].next)
	{
		int y=a[i].y;
		if(!dfn[y])
		{
			dfs(y,root);
			low[x]=min(low[x],low[y]);
//æ›´æ–°å½“å‰èŠ‚ç‚¹çš„lowå€¼ 
			if(low[y]>=dfn[x]&&x!=root) bz[x]=true;
/*éæ ¹ä¸”å­æ ‘èƒ½è¾¾åˆ°çš„dfnæœ€å°çš„ç»“ç‚¹çš„æ—¶é—´>=è‡ªå·±çš„æ—¶é—´æ—¶,
è¯´æ˜å®ƒçš„å­æ ‘ä¸­æœ€æ—©èƒ½è®¿é—®åˆ°çš„ç»“ç‚¹éƒ½æ¯”å®ƒåè®¿é—®,æ­¤æ—¶åªè¦ä¸ä¸ºæ ¹å°±ä¸€å®šæ˜¯å‰²ç‚¹*/ 
			if(x==root) tot++;
//æ›´æ–°å…¥åº¦ 
		}
		low[x]=min(low[x],dfn[y]);
//æŠŠç‚¹xåŠxçš„å­æ ‘å¯ä»¥è¾¾åˆ°çš„dfnçš„æœ€å°ç»“ç‚¹æ›´æ–°
	}
	if(x==root&&tot>=2) bz[root]=true;
//å¦‚æœä¸€ä¸ªç‚¹ä¸ºæ ¹ä¸”å…¥åº¦>=2,åˆ™ä¸€å®šä¸ºå‰²ç‚¹,å› ä¸ºä¸€æ£µæ ‘çš„æ ¹ä¸€åˆ ä¸é‚£ä¹ˆå®ƒçš„å­æ ‘ä¸€å®šä¸è¿é€šäº†
}
int main()
{
	int x,y,t;
	scanf("%d %d",&n,&m);
	for(int i=1;i<=m;i++)
	{
		scanf("%d %d",&x,&y);
		ins(x,y);
		ins(y,x);
	}
	for(int i=1;i<=n;i++)
		if(!dfn[i]) dfs(i,i);
	for(int i=1;i<=n;i++)
		if(bz[i]) ans++;
	printf("%d\n",ans);
	for(int i=1;i<=n;i++)
		if(bz[i]) printf("%d ",i);
}

```









### æœ€å°ç”Ÿæˆæ ‘

**å®šä¹‰** ï¼šå¯¹å¸¦æƒ**è”é€š**æ— å‘å›¾Gï¼Œç”Ÿæˆä¸€æ£µæƒå€¼æœ€å°çš„æ ‘ã€‚

**æ€§è´¨**ï¼š

+ å¯èƒ½å«æœ‰å¤šä¸ªæœ€å°ç”Ÿæˆæ ‘ï¼Œä½†æ˜¯æœ€å°æƒå€¼ä¹‹å’Œå”¯ä¸€ã€‚
+ è¾¹æ•°=ç‚¹æ•° - 1



#### Prim

**æ€æƒ³** ï¼šä»ä¸€ä¸ªé¡¶ç‚¹å¼€å§‹æ„å»ºï¼Œæ¯æ¬¡å°†èŠ±è´¹æœ€å°çš„æ–°é¡¶ç‚¹åŠ å…¥ï¼Œç›´åˆ°æ‰€æœ‰é¡¶ç‚¹éƒ½åŠ å…¥ã€‚

**æ—¶é—´å¤æ‚åº¦** ï¼š$O(\mid V \mid ^2)$   ï¼Œé€‚ç”¨äºç¨ å¯†å›¾

```cpp
//Prim
int maxn;  //æœ€å¤§ç»“ç‚¹æ•°
int INF = 1000000000;
int dis[maxn]; //é¡¶ç‚¹ä¸é›†åˆä¸­ä»»ä¸€ç‚¹çš„æœ€çŸ­è·ç¦»
bool vus[maxn]; //æ˜¯å¦å·²åŠ å…¥
int Prim()
{
    fill(dis,dis+maxn,INF);   //åˆå§‹åŒ–disæ•°ç»„ä¸ºINF
    dis[0]=0;   //é€‰æ‹©0å·ç»“ç‚¹åŠ å…¥ï¼Œåˆ™åªæœ‰0å·èŠ‚ç‚¹è·ç¦»ä¸º0
    int ans = 0;  //ç”±äºä¸€å¼€å§‹åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œæ²¡æœ‰è¾¹ï¼Œæ‰€ä»¥è¾¹æƒä¹‹å’Œä¸º0
    for(int i=0;i<n;i++)
    {
        int u = -1;
        int minn = INF;
        for(int j=0;j<n;j++)
        {
            if(!vis[j] && dis[j]<minn)  //æ²¡è¢«è®¿é—®è¿‡ä¸”è·ç¦»æœ€çŸ­
            {
                u = j;
                minn = dis[j];
            }
        }
        if(u==-1) //æ²¡æœ‰æ‰¾åˆ°
        	reutnr -1;
       	
        vis[u]=1;
        ans+=dis[u];
        for(int v = 0; v<n; v++)
        {
            if(!vis[v] && a[u][v]!=INF && a[u][v]<dis[v])
            {
                dis[v]=a[u][v];
            }
        }
    }
    
    
}
```




#### Kruskal

**æ€æƒ³** ï¼šæ¯æ¬¡é€‰æ‹©æƒå€¼æœ€å°çš„è¾¹åŠ å…¥ï¼Œä¸”ä¸¤ä¸ªç«¯ç‚¹æ²¡æœ‰è”é€šï¼Œç›´åˆ°æ‰€æœ‰ç»“ç‚¹éƒ½è”é€š

**æ—¶é—´å¤æ‚åº¦** ï¼š$O(\textbar E \textbar log_2\textbar E \textbar)$

```cpp
//Kruskal

struct Edge{
    int u;
    int v;
    int w;
}e[maxm];
bool cmp(Edge p,Edge q)
{
    return p.w<q.w;
}

int find(int x)
{
    
    if(fa[x]!=x)
    {
        fa[x]=find(fa[x]);
    }
    return fa[x];
}

void Kruskal()
{
    sort(e+1,e+m+1,cmp);
    for(int i=1;i<=m;i++)
    {
        int faa = find(e[i].u);
        int fab = find(e[i].v);
        if(faa = fab)
            continue;
        fa[fab]=faa;
        ans+=e[i].w;
        if(++cnt == n-1)
            break;
    }
}
```



### å•æºæœ€çŸ­è·¯å¾„

![vro8Og.png](https://s1.ax1x.com/2022/08/19/vro8Og.png)

#### Floyd

**æ€æƒ³** ï¼šæšä¸¾

æ—¶é—´å¤æ‚åº¦ï¼š$O(n^3)$   ï¼Œ    ç©ºé—´å¤æ‚åº¦ï¼š $O(n^2)$

**é€‚ç”¨æ¡ä»¶** ï¼š ä¸èƒ½æœ‰è´Ÿç¯ï¼Œä¸”å¿…é¡»å­˜åœ¨æœ€çŸ­è·¯

```c++
for(int k = 1; k <= n; k++){
    for(int x = 1; x <= n; x++){
        for(int y = 1; y <= n; y++){
            f[x][y]= min(f[x][y], f[x][k]+f[k][y]);
        }
    }
}
```



#### SPFA

[åšå®¢](https://blog.csdn.net/qq_39670434/article/details/78464995)

##### æœ€çŸ­è·¯

**æ€è·¯**ï¼šç”±ä¸€ä¸ªç‚¹ä¸æ–­æ‰©å±•å­èŠ‚ç‚¹ï¼Œå¦‚æœèƒ½å¤Ÿè¿›è¡Œè¿­ä»£ï¼Œé‚£ä¹ˆå…¥é˜Ÿï¼Œè¢«å…¥é˜Ÿçš„ç‚¹å†è¿›è¡Œæ‰©å±•....

```cpp
void SPFA()
{
    for(int i=1;i<=n;i++)
    {
        dis[i]=maxint;
        vis[i]=false;
    }
    dis[s]=0;
    vis[s]=true;
    int u;
    q.push(s);
    while(!q.empty())
    {
        u=q.front();
        for(int i=head[u];i;i=e[i].nxt)
        	if(dis[u]+e[i].len<dis[e[i].to])
        	{
            	dis[e[i].to]=dis[u]+e[i].len;
            	if(vis[e[i].to]==false)
            	{
                	vis[e[i].to]=true;
                	q.push(e[i].to);
            	}
        	}
        vis[q.front()]=false;
      	q.pop();
    }
}
```



##### è´Ÿç¯

æ¯æ¬¡å…¥é˜Ÿçš„æ—¶å€™è®°å½•ä¸€ä¸‹

```cpp
bool SPFA() {
    dis[1] = 0;
    vis[1] = true;
    q.push(1);
    while (!q.empty()) {
        int u = q.front();
        q.pop();
        vis[u] = false;
        for (int i = head[u]; i; i = e[i].nex) {
            int to = e[i].to;
            if (e[i].val + dis[u] < dis[to]) {
                dis[to] = dis[u] + e[i].val;
                cnt[to] = cnt[u] + 1;
                if (cnt[to] >= n) return true;
                if (!vis[to]) {
                    q.push(to);
                    vis[to] = true;
                }
            }
        }
    }
    return false;
}
```



##### å·®åˆ†çº¦æŸ

[åšå®¢](https://blog.csdn.net/qq_49688477/article/details/125613544?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-125613544-blog-72849441.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-125613544-blog-72849441.pc_relevant_default&utm_relevant_index=1)

```cpp
asd
```







#### Dijkstra

**æ€æƒ³** ï¼šç±»ä¼¼äº Prim ï¼Œä¸æ–­æ‰¾åˆ°è€—è´¹æœ€å°çš„ç‚¹ï¼Œè¿›è¡Œæ ‡è®°ï¼Œç›´åˆ°è¾¾åˆ°ç›®æ ‡

æ—¶é—´å¤æ‚åº¦ï¼š $O(n^2)$    ï¼Œ  ç©ºé—´å¤æ‚åº¦ï¼š $O(m log m)$

```c++
const int inf=0x3f3f3f3f; //ä»£è¡¨æ— ç©·å¤§ã€‚
const int maxn=100;//æœ€å¤§é¡¶ç‚¹æ•°
int n,m;//nä¸ªé¡¶ç‚¹ï¼Œmæ¡è¾¹ã€‚
bool visited[maxn];//åˆ¤æ–­æ˜¯å¦ç¡®å®šåˆ°æºç‚¹çš„æœ€ç»ˆæœ€çŸ­è·ç¦»ã€‚
int graph[maxn][maxn];//å¸¦æƒå›¾
int dis[maxn];//é¡¶ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·ç¦»ã€‚
int start,goal;//èµ·ç‚¹ä¸ç›®æ ‡ç‚¹ã€‚


void init(){
	memset(visited,false,sizeof(visited));
	for(int i=1;i<=n;i++){
		dis[i]=graph[start][i];//åˆå§‹åŒ–disæ•°ç»„ã€‚
	}
}


void dijkstra(){
	//æºç‚¹ä¸ºæºç‚¹startã€‚
	int minn;//è®°å½•æ¯è¶Ÿæœ€çŸ­è·¯å¾„ä¸­æœ€å°çš„è·¯å¾„å€¼ã€‚ 
	int pos;//è®°å½•å¾—åˆ°çš„minnæ‰€å¯¹åº”çš„ä¸‹æ ‡ã€‚
	init();//è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ã€‚
	visited[start]=true;
	for(int i=1;i<=n;i++){
		//å°†nä¸ªé¡¶ç‚¹ä¾æ¬¡åŠ å…¥åˆ¤æ–­ã€‚
		minn=inf;
		for(int j=1;j<=n;j++){
			if(!visited[j]&&dis[j]<minn){
				minn=dis[j];
				pos=j;
			}
		}
		//ç»è¿‡è¿™è¶Ÿforå¾ªç¯åæˆ‘ä»¬æ‰¾åˆ°çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç‚¹ï¼Œå¯ä»¥ç¡®å®šè¿™ç‚¹åˆ°æºç‚¹çš„æœ€ç»ˆæœ€çŸ­è·ç¦»äº†ã€‚
		visited[pos]=true;//æˆ‘ä»¬å°†æ­¤ç‚¹å¹¶å…¥å·²çŸ¥é›†åˆã€‚
		//æ¥ä¸‹æ¥å°±æ˜¯æ›´æ–°disæ•°ç»„äº†ï¼Œä¹Ÿå°±æ˜¯å½“å‰æœ€çŸ­è·ç¦»ï¼Œè¿™éƒ½æ˜¯é’ˆå¯¹è¿˜æ²¡æœ‰å¹¶å…¥å·²çŸ¥é›†åˆçš„ç‚¹ã€‚
		for(int j=1;j<=n;j++){
			if(!visited[j]&&dis[j]>dis[pos]+graph[pos][j])
				dis[j]=dis[pos]+graph[pos][j];
		}
	}
	//é€€å‡ºå¾ªç¯åï¼Œæ‰€æœ‰çš„ç‚¹éƒ½å·²å¹¶å…¥å·²çŸ¥é›†åˆä¸­ï¼Œå¾—åˆ°çš„disæ•°ç»„ä¹Ÿå°±æ˜¯æœ€ç»ˆæœ€çŸ­è·ç¦»äº†ã€‚
	cout<<dis[goal]<<endl;//è¾“å‡ºç›®æ ‡ç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚
}

```



##### ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ç‰ˆ

**æ€æƒ³** ï¼šåˆ©ç”¨æœ€å°å †ç»´æŠ¤æœ€å°å€¼ï¼Œä¸ç”¨å†å»å¾ªç¯æšä¸¾æ‰¾å‡ºæœ€å°å€¼ã€‚

**æ—¶é—´å¤æ‚åº¦**ï¼š$MlogM$

```cpp
typedef pair<int,int> pdd;

int head[maxn], dis[maxn];
bool vis[maxn];

struct Edge{
    itn u,v,w;
    int nex;
}e[maxm];

inline void add(int a,int b,int c)
{
    e[++cnt].u=a;
    e[cnt].v=b;
    e[cnt].w=c;
    e[cnt].nex=head[a];
    head[a]=cnt;
}

priority_queue<pdd,vector<pdd>,greater<pdd>> q;

void dijkstra()
{
    while(!empty())
    {
        pdd t = q.top();
        q.pop();
        int now = t.second;
        if(vis[now])
            continue;
        vie[now]=true;
        
        for(int i = head[now]; i; i = e[i].nex)
        {
            int to = e[i].v;
            if(dis[to]>dis[now]+e[i].w)
            {
                dis[to]= dis[now] + e[i].w;
                q.push({dis[to],to});
            }
        }
    }
    
}
```





### æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰

åšå®¢[é“¾æ¥](https://blog.csdn.net/qq_43332980/article/details/107437070?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107437070-blog-121195470.pc_relevant_multi_platform_featuressortv2removedup&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107437070-blog-121195470.pc_relevant_multi_platform_featuressortv2removedup)

#### å€å¢ï¼ˆåœ¨çº¿ï¼‰

##### å¤æ‚åº¦

é¢„å¤„ç†ï¼š`O(nlogn)`

å•æ¬¡æŸ¥è¯¢ï¼š`O(logn)`

æ€»å¤æ‚åº¦ï¼š`O(nlogn+mlogn)`

##### å®ç°

é‡‡ç”¨`f[x][i]`æ•°ç»„æ¥è¡¨ç¤ºç‚¹ x çš„ç¬¬ $2^i$ ä¸ªç¥–å…ˆ

```cpp
//é¢„å¤„ç†fæ•°ç»„
for(int i=1;(i<<i)<d[u];i++)
{
  	f[u][i] = f[f[u][i-1]][i-1];
}
```

```cpp
#include<bits/stdc++.h>
using namespace std;

const int MAX_N = 500000+7, MAX_M = 500000+7;

int n,m,s;
int d[MAX_N]; //ä¿å­˜èŠ‚ç‚¹æ·±åº¦
int f[MAX_N][21]; //ä¿å­˜èŠ‚ç‚¹çš„ä¸åŒå€æ•°çš„çˆ¶èŠ‚ç‚¹

int head[MAX_N], cnt=-1;
struct Edge{
    int to , next;
}e[MAX_N*2];

void add(int u,int v){
    e[++cnt].to = v;
    e[cnt].next = head[u];
    head[u] = cnt;
}

void dfs(int u,int fa) // uä¸ºå½“å‰èŠ‚ç‚¹,faä¸ºçˆ¶èŠ‚ç‚¹
{
    f[u][0] = fa;
    d[u] = d[fa]+1;

    for(int i=1;(1<<i)<=d[u];i++)
        f[u][i] = f[f[u][i-1]][i-1];    //é¢„å¤„ç†fæ•°ç»„

    for(int i=head[u];i!=-1;i=e[i].next){
        int v = e[i].to;
        if(v!=fa)
            dfs(v,u);
    }
}

int lca(int x,int y)
{
    if(d[x]>d[y])  //ä»¤yä¸ºæ›´æ·±èŠ‚ç‚¹
    	swap(x,y);
    
    for(int i=20;i>=0;i--){   //è¿™é‡Œä½¿å¾—xä¸yå¤„äºåŒä¸€æ·±åº¦
        if(d[x]<=d[y]-(1<<i))
            y=f[y][i];
    }

    //ç‰¹åˆ¤
    if(x==y)
        return x;
    
    for(int i=20;i>=0;i--)
    {
        if(f[x][i]==f[y][i])
            continue;              //è¿™é‡Œæ˜¯ä»æœ€è¿œçš„å…¬å…±ç¥–å…ˆå¼€å§‹æ‰¾ï¼Œæ‰€ä»¥éœ€è¦continue
        else
            x=f[x][i],y=f[y][i];   //ä¸Šè·³
    }

    return f[x][0];
}

int main()
{
    memset(head,-1,sizeof(head));
    int a,b;
    scanf("%d%d%d",&n,&m,&s);
    for(int i=1;i<n;i++)
    {
        scanf("%d%d",&a,&b);
        add(a,b);
        add(b,a);                      //æ— å‘å›¾ï¼Œè¦åŠ ä¸¤æ¬¡
    }
    dfs(s,0);

    for(int i=1;i<=m;i++)
    {
        scanf("%d%d",&a,&b);
        printf("%d\n",lca(a,b));
    }

    return 0;
}

```



#### ST+RMQ(åœ¨çº¿)

##### å¤æ‚åº¦

é¢„å¤„ç†ï¼š`O(logn)`

æŸ¥è¯¢ï¼š`O(1)`

æ€»å¤æ‚åº¦ï¼š`O(nlogn+m)`

##### åŸç†

å°†ä¸€æ£µæ ‘è½¬ä¸ºdfsåºåï¼Œä¹Ÿå°±æ˜¯è¯´dfsåºçš„ä¸€æ®µåŒºé—´æ˜¯åŸæ ‘çš„ä¸€æ£µå­æ ‘ã€‚

è€Œè¦æŸ¥æ‰¾ä¸¤ä¸ªç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œåªè¦æ‰¾dfsåºä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´æ·±åº¦æœ€å°çš„é‚£ä¸ªç‚¹å³å¯ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;

const int MAX_N = 500000+7, MAX_M = 500000+7;

int n,m,s;

//dfsåºæ•°ç»„
int tot = 0;
int fir[MAX_N];
int dfn[MAX_N*2];
int d[MAX_N*2];

//STè¡¨æ•°ç»„
int st[20][MAX_N*2];   //stè¡¨
int ist[20][MAX_N*2];  //è®°å½•æœ€å€¼ä¸‹æ ‡
int Log[MAX_N*2];

void getLog()
{
	Log[1] = 0;
	for(int i=2;i<=MAX_N*2;i++)
		Log[i] = Log[i/2]+1;
}

void init()
{
    for(int i=1;i<=tot;i++){
        st[0][i]=d[i];
        ist[0][i] = dfn[i];
    }
    for(int j=1;(1<<j)<=tot;j++){
		for(int i=1;i+(1<<(j-1))<=tot;i++){
            if(st[j-1][i]<st[j-1][i+(1<<(j-1))]){
                st[j][i] = st[j-1][i];
                ist[j][i] = ist[j-1][i];
            }else{
                st[j][i] = st[j-1][i+(1<<(j-1))];
                ist[j][i] = ist[j-1][i+(1<<(j-1))];
            }
        }
    }

    getLog();
}

int Query(int l,int r)
{
	int k=Log[r-l+1];
	int ans;

    if(st[k][l]<st[k][r-(1<<k)+1]) 
        ans = ist[k][l];
    else 
        ans = ist[k][r-(1<<k)+1];

    return ans;
}


int head[MAX_N], cnt=-1;
struct Edge{
    int to , next;
}e[MAX_N*2];

void add(int u,int v){
    e[++cnt].to = v;
    e[cnt].next = head[u];
    head[u] = cnt;
}

void dfs(int u,int dep) // uä¸ºå½“å‰èŠ‚ç‚¹,depä¸ºæ·±åº¦
{
    fir[u] = ++tot;
    dfn[tot] = u;
    d[tot] = dep;

    for(int i=head[u];i!=-1;i=e[i].next){
        int v = e[i].to;
        if(!fir[v]){
            dfs(v,dep+1);
            dfn[++tot]=u;
            d[tot]=dep;
        }
    }
}


int lca(int x,int y)
{
    int l = fir[x] , r = fir[y];
    if(l>r) swap(l,r);
    return Query(l,r);
}


int main()
{
    memset(head,-1,sizeof(head));
    int a,b;
    scanf("%d%d%d",&n,&m,&s);
    for(int i=1;i<n;i++)
    {
        scanf("%d%d",&a,&b);
        add(a,b);
        add(b,a);                      //æ— å‘å›¾ï¼Œè¦åŠ ä¸¤æ¬¡
    }
    dfs(s,0);
    init();

    for(int i=1;i<=m;i++)
    {
        scanf("%d%d",&a,&b);
        printf("%d\n",lca(a,b));
    }

    return 0;
}

```

#### Tarjanï¼ˆç¦»çº¿ï¼‰ å­˜åœ¨é—®é¢˜ï¼Œæ´›è°·æ¨¡æ¿è¿‡ä¸äº†

##### æ€è·¯

+ ä»»é€‰ä¸€ä¸ªç‚¹uä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¼€å§‹éå†
+ éå†æ‰€æœ‰çš„å­èŠ‚ç‚¹vï¼Œå¹¶è¿›è¡Œæ ‡è®°
+ è‹¥æœ‰å­èŠ‚ç‚¹vè¿˜æœ‰å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé‡å¤ç¬¬äºŒæ­¥ï¼Œç»§ç»­éå†
+ åˆå¹¶våˆ°uä¸Šï¼ˆä½¿ç”¨å¹¶æŸ¥é›†ï¼‰
+ å¯»æ‰¾ä¸uæœ‰å…³ç³»çš„æŸ¥è¯¢èŠ‚ç‚¹v
+ è‹¥vå·²è¢«è®¿é—®è¿‡ï¼Œåˆ™å¯ä»¥ç›´æ¥æ±‚å‡ºLCAï¼Œå³ä¸ºvè¢«åˆå¹¶åˆ°çš„çˆ¶äº²ç»“ç‚¹

**ä¼ªä»£ç **ï¼š

```cpp
Tarjan(u)//margeå’Œfindä¸ºå¹¶æŸ¥é›†åˆå¹¶å‡½æ•°å’ŒæŸ¥æ‰¾å‡½æ•°
{
    for each(u,v)    //è®¿é—®æ‰€æœ‰uå­èŠ‚ç‚¹v
    {
        Tarjan(v);        //ç»§ç»­å¾€ä¸‹éå†
        marge(u,v);    //åˆå¹¶våˆ°uä¸Š
        æ ‡è®°vè¢«è®¿é—®è¿‡;
    }
    for each(u,e)    //è®¿é—®æ‰€æœ‰å’Œuæœ‰è¯¢é—®å…³ç³»çš„e
    {
        å¦‚æœeè¢«è®¿é—®è¿‡;
        u,eçš„æœ€è¿‘å…¬å…±ç¥–å…ˆä¸ºfind(e);
    }
}
```

```cpp
void Tarjan(int u,int fa) // uä¸ºå½“å‰èŠ‚ç‚¹,faä¸ºçˆ¶èŠ‚ç‚¹
{

    for(int i=head[u];i!=0;i=e[i].next){
        int v = e[i].to;
        if(v!=fa&&!vis[v]){
            Tarjan(v,u);
            unionn(u,v);   // æ³¨æ„è¿™é‡Œä½ç½®ä¸èƒ½äº¤æ¢ï¼Œ åŸæ ‘ä¸Šuä¸ºvçš„çˆ¶èŠ‚ç‚¹
            vis[v]=true;   // æ ‡è®°è®¿é—®
        }
    }

    for(int i=que[u];i!=0;i=q[i].next){
        int v = q[i].to;
        if(!q[i].flag&&vis[v]){
            ans[q[i].num] = find(v);
            q[i].flag = true;           //å®Œæˆè¯¢é—®åˆ™æŠŠé•œåƒé—®é¢˜ä¹Ÿæ‰“ä¸Šæ ‡è®°
            q[q[i].same].flag = true;
        }
    }
}
```



### æ ‘é“¾å‰–åˆ†

#### ä½¿ç”¨åœºæ™¯

+ ä»å­èŠ‚ç‚¹åˆ°æ ¹ç»“ç‚¹åˆ°è·¯ç¨‹ä¸­ æ“ä½œ
+ ä»æ ¹èŠ‚ç‚¹åˆ°å…¶æ‰€æœ‰å­èŠ‚ç‚¹ æ“ä½œ

æ¦‚å¿µï¼š**é‡å„¿å­** --- ä¸€ä¸ªèŠ‚ç‚¹ä¸­å­æ ‘æœ€å¤§çš„å„¿å­ã€‚

**å¯»æ‰¾é‡å„¿å­**

```cpp
void dfs_getson(int x)
{
  	size[x] = 1;
  	for(int i = head[x];i; i = e[i].nex)
    {
      int v = e[i].to;
      if(v == fa[x]) continue; //ä¸èƒ½å¾€å›èµ°
      fa[v] = x; 
      deep[v] = deep[x] + 1; //è®°å½•çˆ¶äº²å’Œæ·±åº¦
      dfs_getson(v);
      size[x]+=size[v];
      if(size[v]>size[son[x]]) 
        son[x]=v; //æ›´æ–°é‡å„¿å­
    }
}
```

**å°†å¯»æ‰¾åˆ°çš„é‡å„¿å­è¿æ¥èµ·æ¥ï¼Œæˆä¸ºé‡è¾¹**

```cpp
void dfs_rewrite(int x,int tp)//å½“å‰ç‚¹ä»¥åŠå½“å‰ç‚¹æ‰€åœ¨é‡é“¾çš„é¡¶ç«¯
{
    top[x]=tp;  //æ›´æ–°æ¯ä¸ªç‚¹æ‰€åœ¨çš„é‡é“¾çš„é¡¶ç«¯ 
    id[x]=++cnt;//å¾—åˆ°æ¯ä¸ªç‚¹çš„dfsåºï¼ˆæ–°ç¼–å·ï¼‰ 
    rk[tot]=x;  //è®°å½•æ¯ä¸ªæ–°ç¼–å·å¯¹åº”çš„åŸæ¥çš„ç‚¹ 
    if(son[x])
      dfs_rewrite(son[x],tp);//ä¼˜å…ˆå¾€é‡å„¿å­é‚£é‡Œèµ° 
    for(int i=head[x];i;i=e[i].next)
    {
        int v=e[i].to;
        if(v!=son[x] && v!=fa[x])
          dfs_rewrite(v,v);
    }
    ctr[x]=tot; //ä½œç”¨åé¢ä¼šè®² 
}
```











## æ•°è®º

### å®¹æ–¥åŸç†

[åšå®¢](https://blog.csdn.net/AGNING/article/details/105371507?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166062540216780357250140%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166062540216780357250140&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105371507-null-null.142^v40^pc_rank_34_2,185^v2^control&utm_term=å®¹æ–¥åŸç†&spm=1018.2226.3001.4187)

#### æ¦‚å¿µ

[![vsYttx.png](https://s1.ax1x.com/2022/08/20/vsYttx.png)](https://imgse.com/i/vsYttx)

è¦æŠŠ1-nä¸­2ã€3ã€5çš„å€æ•°å…¨éƒ¨ç­›æ‰ï¼Œé‚£ä¹ˆå…ˆç­›2çš„å€æ•°ï¼Œå†ç­›3çš„å€æ•°ï¼Œå†ç­›5çš„å€æ•°ï¼Œè¿™æ ·çš„è¯6ã€10ã€15çš„å€æ•°å°±è¢«ç­›äº†ä¸¤éï¼Œ30çš„å€æ•°å°±è¢«ç­›äº†ä¸‰éã€‚å› æ­¤ï¼Œåªè¦å‡å»6ã€10ã€15çš„å€æ•°ï¼Œä½†æ˜¯è¿™æ ·ä¸€å‡ï¼Œ30çš„å€æ•°åˆè¢«å‡äº†3éï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ30çš„å€æ•°æ²¡æœ‰è¢«åŠ è¿‡ï¼Œæ‰€ä»¥å†åŠ ä¸Šå°±å¯ä»¥äº†ã€‚

å®¹æ–¥åŸç†å¯ä»¥ç”¨æ¥æ±‚1-nä¸­çš„æ‰€æœ‰è´¨æ•°ã€‚

#### å®ç°

å…ˆåˆ†è§£è´¨å› å­ï¼š

```cpp
 for (int i = 2; i * i <= k; i++) {
        if (k % i == 0) {
            p[++tail] = i;  //på°±æ˜¯å‚¨å­˜è´¨å› å­çš„æ•°ç»„
            while (k % i == 0) k /= i;  //æŠŠkä¸­æ‰€æœ‰içš„è´¨å› å­å…¨éƒ¨é™¤å»
        }
    }
    if (k > 1) p[++tail] = k;  //æœ€åå¦‚æœå¤§äºä¸€ï¼Œåˆ™æœ€åä¸€ä¸ªæ•°ä¸€å®šæ˜¯è´¨å› å­ï¼Œè¿™ä¸€æ­¥å¯èƒ½æœ‰ä¸€ç‚¹éš¾ç†è§£ï¼Œå¯ä»¥å¤šæƒ³æƒ³
```

å†å®ç°å®¹æ–¥ï¼š

```cpp
long long fun(long long x){
    long long res=0;  //è®°å½•1-xä¸­ä¸kä¸äº’è´¨çš„æ•°é‡
    for(int i=1;i<(1<<tail);i++){  //è¿™é‡Œçš„1<<tailæ˜¯æŒ‡2çš„tailæ¬¡æ–¹ï¼Œè¡¨ç¤ºtailä¸ªè´¨å› å­æœ‰å¤šå°‘ç§ç»„åˆæƒ…å†µ 
        long long cur=1,cnt=0;  //curè¡¨ç¤ºåœ¨å½“å‰é€‰ä¸­çš„è´¨å› å­ä¸­çš„ä¹˜ç§¯ï¼Œcntè¡¨ç¤ºå½“å‰é€‰ä¸­çš„æ•°é‡æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•° 
        for(int j=0;j<tail;j++){  //è¿™ä¸ªå¾ªç¯æ˜¯æšä¸¾tailçš„äºŒè¿›åˆ¶å½¢å¼ 
            if((i>>j)&1){  //è¿™ä¸ªæ˜¯åˆ¤æ–­içš„ç¬¬jä½æ˜¯ä¸æ˜¯1ï¼Œå¦‚æœæ˜¯åˆ™è¡¨ç¤ºé€‰ä¸­ç¬¬jä¸ªæ•° 
                cnt++;  //è¡¨ç¤ºé€‰ä¸­äº†å‡ ä¸ªæ•°ï¼Œæ¯é€‰ä¸­ä¸€ä¸ªå°±åŠ ä¸€ 
                cur*=p[j+1];  //é€‰ä¸­ç¬¬jä¸ªæ•°å°±ç”¨curä¹˜ä»¥ç¬¬jä¸ªè´¨å› å­æ•°ï¼Œæ³¨æ„è´¨å› å­æ•°ç»„æ˜¯ä»1å¼€å§‹çš„ï¼Œæ‰€ä»¥è¦åŠ ä¸€ 
            }
        }
        if(cnt&1) res+=x/cur;  //å¦‚æœcntæ˜¯å¶æ•°å°±ç›¸åŠ  
        else res-=x/cur;  //å¥‡æ•°å°±ç›¸å‡ 
    }
    return x-res;  //reså‚¨å­˜çš„æ˜¯1-xä¸­ä¸Kä¸äº’è´¨çš„æ•°é‡ï¼Œæ‰€ä»¥è¦ç”¨x-reså¾—åˆ°äº’è´¨çš„æ•°é‡ 
}


```





### åº·æ‰˜å±•å¼€

**å®šä¹‰** ï¼šç»™å®šè‡ªç„¶æ•°æ’åˆ—ï¼Œæ±‚å‡ºç”±å°åˆ°å¤§ä¸­æ‰€æœ‰æ’åˆ—çš„è¯¥æ’åˆ—åºå·

![](https://i.bmp.ovh/imgs/2022/08/19/8b20cd5cf04fcce4.png)

ä»¥ä¸‹æ˜¯O(n^2)åšæ³•ï¼Œå¯ç”¨æ ‘çŠ¶æ•°ç»„å­˜tmpï¼Œå°†æ—¶é—´å¤æ‚åº¦é™ä½åˆ°O(nlogn)


```cpp
void jiecheng(int x)
{
    f[0]= f[1] =1;
    for(int i = 2; i <= n; i++) f[i] = f[i - 1] * i;
}
int kangtuo()
{
    int ans =1;
    int len = str.length();
    
    for(int i=0;i<len;i++)
    {
        int tmp =0;
        for(int j=i+1;j<len;j++)
        {
            if(str[i]>str[j]) tmp++;
        }
        ans+=tmp*f[len-i+1];
    }
    return ans;
}
```



#### é€†å±•å¼€

**å®šä¹‰** ï¼šç»™å®šä¸€ä¸ªåºå·ï¼Œæ±‚å‡ºå¯¹åº”çš„è‡ªç„¶æ•°æ’åˆ—

```cpp
void jie_cheng(int n)
{
    f[0] = f[1] = 1; // 0çš„é˜¶ä¹˜ä¸º1
    for(int i = 2; i <= n; i++) f[i] = f[i - 1] * i;
}

vector<char> vec; //å­˜éœ€è¦æ’åˆ—çš„å­—ç¬¦
void rev_kangtuo(int k) //è¾“å‡ºåºå·ä¸º k çš„å­—ç¬¦åºåˆ—
{
    int n = vec.size(), len = 0;
    string ans = "";
    k--; // ç®—çš„æ—¶å€™æ˜¯æŒ‰ 12345 æ˜¯ç¬¬0ä½
    for(int i = 1; i <= n; i++){
        int t = k / f[n - i]; // ç¬¬ i ä½éœ€è¦ ç¬¬ t + 1 å¤§çš„æ•°
        k %= f[n - i];        //å‰©ä¸‹çš„å‡ ä½éœ€è¦æä¾›çš„æ’åˆ—æ•°
        ans += vec[t] ; //  vec[t] å°±æ˜¯ç¬¬ t + 1 å¤§çš„æ•°
        vec.erase(vec.begin() + t); 
//ç”¨è¿‡å°±åˆ äº†ï¼Œä¸ç”¨vectorç”¨æš´åŠ›ä¹Ÿå¯ä»¥ï¼Œå°±æ˜¯è¯´æšä¸¾ï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªçš„æ¯”è¾ƒå¤§å°ï¼Œå¹¶è®°å½•æœ‰å‡ ä¸ªæ²¡ç”¨è¿‡çš„å­—ç¬¦ä¸”å­—å…¸åºæ¯”å®ƒå°
    }
    cout << ans << '\n';
}
```



### ä¹˜æ³•é€†å…ƒ

#### å®šä¹‰

â€‹	è‹¥**a**ä¸**p**äº’è´¨ a * b = 1 (mod p) --> aä¸bçš„ä¹˜ç§¯åœ¨æ¨¡pæ—¶æ’ç­‰äº1ï¼Œåˆ™bæ˜¯aåœ¨æ¨¡pæƒ…å†µä¸‹çš„é€†å…ƒ

â€‹	å¯ä»¥æ ¹æ®ä¹˜æ³•é€†å…ƒï¼Œå°† (a / b) % c è½¬åŒ–ä¸º (a * x) % c ï¼Œå°†é™¤æ³•è½¬åŒ–ä¸ºä¹˜æ³•ã€‚

#### è§£æ³•

##### è´¹é©¬å°å®šç†

â€‹	å‡å¦‚pæ˜¯è´¨æ•°ï¼Œä¸”$gcd(a,p)=1$ï¼Œé‚£ä¹ˆ $a^ {p-1}â‰¡1(mod p)$ ã€‚

â€‹	æ ¹æ®è´¹é©¬å°å®šç†ï¼Œa çš„é€†å…ƒå³ä¸º $a^{p-2}$

```cpp
éœ€è¦ç»“åˆå¿«é€Ÿå¹‚
ll fpm(ll x, ll power, ll mod) {
    x %= mod;
    ll ans = 1;
    for (; power; power >>= 1, (x *= x) %= mod)
    	if(power & 1) (ans *= x) %= mod;
    return ans;
}
int main() {
	ll x = fpm(a, p - 2, p); //xä¸ºaåœ¨mod pæ„ä¹‰ä¸‹çš„é€†å…ƒ
}
```



##### æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†

â€‹	å¿…å­˜åœ¨ x y ï¼Œæ»¡è¶³ç­‰å¼ a*x + b*y = gcd(a,b)  å› æ­¤ï¼Œè‹¥gcd(a,b)=1ï¼Œåˆ™å¯ä»¥æ±‚ä¹˜æ³•é€†å…ƒ

å¯é€’å½’å¾—å‡ºç»“è®ºï¼š` x = y' ,y = x'- a/b * y'`

```cpp
void exgcd(ll a, ll b, ll &x, ll &y)
{
    if (!b) //é€’å½’åˆ°ç‰¹è§£å¼€å§‹å›æº¯
    {
        x = 1;
        y = 0;
        return;
    }
    exgcd(b, a % b, x, y); //æ±‚å¾—x2,y2
    ll temp = x;
    x = y;                  //å›æº¯ï¼Œåˆ©ç”¨x2é€’æ¨x1
    y = temp - (a / b) * y; //å›æº¯ï¼Œåˆ©ç”¨y2é€’æ¨y1
}
int main()
{
    ll a, b, x, y;
    cin >> a >> b;
    exgcd(a, b, x, y);
    cout << x << ' ' << y << endl;
    return 0;
}
```

##### é€’æ¨å…¬å¼

ä»ä¸€åˆ°nçš„é€†å…ƒï¼š

è¿™ä¸ªå¼å­å¿…é¡»ä»1å¼€å§‹é€’æ¨

![image.png](https://s2.loli.net/2022/08/20/MLnIpJgbjHkRP7Y.png)



### æ¬§æ‹‰å®šç†

**å®šä¹‰** ï¼šå¯¹ä»»æ„ä¸¤ä¸ªæ­£æ•´æ•°a,nï¼Œè‹¥ä¸¤è€…äº’è´¨ï¼Œåˆ™$a^{Ï†(n)}â‰¡1(mod n)$

â€‹	å¯ç”¨äºé™å¹‚æ“ä½œã€‚

#### å‰ç½®çŸ¥è¯†

**æ¬§æ‹‰å‡½æ•°**ï¼šå¯¹æ­£æ•´æ•°nï¼Œæ¬§æ‹‰å‡½æ•° $Ï†(n)$ æ˜¯å°äºnçš„æ­£æ•´æ•°ä¸­ä¸näº’è´¨çš„æ•°çš„æ•°ç›®ã€‚

```cpp
typedef long long ll;
ll Eular(ll n)
{
    ll ans=n;
    for(int i=2; i*i <= n; ++i)
    {
        if(n%i == 0)
        {
            ans = ans/i*(i-1);
            while(n%i == 0)
                n/=i;
        }
    }
    if(n > 1) ans = ans/n*(n-1);
    return ans;
}
```

è‹¥nä¸ºè´¨æ•°ï¼Œåˆ™ $Ï†(n) = n-1$ 

#### æ‰©å±•æ¬§æ‹‰å®šç†

![](https://i.bmp.ovh/imgs/2022/08/19/dee20be7eed215b7.png)

##### åº”ç”¨èŒƒå›´

æ‰©å±•æ¬§æ‹‰å®šç†é€‚ç”¨äºæ¨¡æ•°è¾ƒå°ï¼ŒæŒ‡æ•°è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œé™å¹‚æ“ä½œã€‚

+ é…åˆå¤§æ•°å–ä½™æ±‚è§£

e.g. ç»™å®š a,m,bï¼Œ æ±‚ $a^b mod\ m$ 



### æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†

#### åº”ç”¨

##### äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹







### é«˜æ–¯æ¶ˆå…ƒæ³•









### Lucas

[åšå®¢](https://blog.csdn.net/qq_40679299/article/details/80489761)

